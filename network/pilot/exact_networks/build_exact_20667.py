# -*- coding: utf-8 -*-
"""
Created on Fri Jul 16 09:47:53 2021

@author: Gergő
"""

import pandapower as pp

from network.pilot.corr_20667 import corr_exact


def create(path='.'):
    # empty net
    net = pp.create_empty_network()
    trafo_data = {'vn_hv_kv': 11, 'vn_lv_kv': 0.42,
                  'vk_percent': 5.879, 'vkr_percent': 1.2,
                  'vk0_percent': 5.879, 'vkr0_percent': 1.2,
                  'sn_mva': 0.63, 'i0_percent': 2,
                  'vector_group': 'Dyn5', "shift_degree": 150,
                  'pfe_kw': 0.75}
    # create type for the trafo
    pp.create_std_type(net, trafo_data, name='4HB5844-4ZA', element='trafo')
    trafo_mv_side = pp.create_bus(net, vn_kv=11, name="Trafo MV")
    trafo_lv_side = pp.create_bus(net, vn_kv=0.42, name="Trafo LV")
    # Create bus for external grid
    bus0 = pp.create_bus(net, vn_kv=11, name="Ext grid")
    pp.create_transformer(net, hv_bus=trafo_mv_side, lv_bus=trafo_lv_side, std_type='4HB5844-4ZA')
    # Create external grid and switch
    pp.create_ext_grid(net, bus=bus0)
    pp.create_switch(net, bus=bus0, element=trafo_mv_side, et='b', closed=True, type='CB', name='S1')
    _4x95Al = {"r_ohm_per_km": 0.311, "x_ohm_per_km": 0.34, "c_nf_per_km": 0, "max_i_ka": 0.25,
               "r0_ohm_per_km": 1.244, "x0_ohm_per_km": 1.36, "c0_nf_per_km": 0}
    pp.create_std_type(net, _4x95Al, name="4x95 Al", element="line")
    _4x95Ml = {"r_ohm_per_km": 0.311, "x_ohm_per_km": 0.071, "c_nf_per_km": 0, "max_i_ka": 0.16,
               "r0_ohm_per_km": 1.244, "x0_ohm_per_km": 0.284, "c0_nf_per_km": 0}
    pp.create_std_type(net, _4x95Ml, name="4x95 Ml", element="line")
    _4x50Al = {"r_ohm_per_km": 0.603, "x_ohm_per_km": 0.357, "c_nf_per_km": 0, "max_i_ka": 0.16,
               "r0_ohm_per_km": 2.412, "x0_ohm_per_km": 1.428, "c0_nf_per_km": 0}
    pp.create_std_type(net, _4x50Al, name="4x50 Al", element="line")
    _10_Al_plus_25_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.4, "c_nf_per_km": 0, "max_i_ka": 50}
    pp.create_std_type(net, _10_Al_plus_25_Al, name="10_Al_plus_25_Al", element="line")
    _3x10_Al_plus_25_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.4, "c_nf_per_km": 0, "max_i_ka": 50}
    pp.create_std_type(net, _3x10_Al_plus_25_Al, name="3x10_Al_plus_25_Al", element="line")
    _3x10_ML_plus_25_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.091, "c_nf_per_km": 0, "max_i_ka": 32}
    pp.create_std_type(net, _3x10_ML_plus_25_Al, name="3x10_ML_plus_25_Al", element="line")
    _3x16_Al = {"r_ohm_per_km": 1.83, "x_ohm_per_km": 0.39, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _3x16_Al, name="3x16_Al", element="line")
    _3x16_Al_plus_25_Al = {"r_ohm_per_km": 1.83, "x_ohm_per_km": 0.39, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _3x16_Al_plus_25_Al, name="3x16_Al_plus_25_Al", element="line")
    _3x240_Al_kbl_plus_120_Al_kbl = {"r_ohm_per_km": 0.125, "x_ohm_per_km": 0.088, "c_nf_per_km": 0, "max_i_ka": 250}
    pp.create_std_type(net, _3x240_Al_kbl_plus_120_Al_kbl, name="3x240_Al_kbl_plus_120_Al_kbl", element="line")
    _3x70_Al_plus_50_Al = {"r_ohm_per_km": 0.447, "x_ohm_per_km": 0.35, "c_nf_per_km": 0, "max_i_ka": 200}
    pp.create_std_type(net, _3x70_Al_plus_50_Al, name="3x70_Al_plus_50_Al", element="line")
    _4x10_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.4, "c_nf_per_km": 0, "max_i_ka": 50}
    pp.create_std_type(net, _4x10_Al, name="4x10_Al", element="line")
    _4x10_ML = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.091, "c_nf_per_km": 0, "max_i_ka": 32}
    pp.create_std_type(net, _4x10_ML, name="4x10_ML", element="line")
    _4x120_Al_kbl = {"r_ohm_per_km": 0.253, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 160}
    pp.create_std_type(net, _4x120_Al_kbl, name="4x120_Al_kbl", element="line")
    _4x150_Al_kbl = {"r_ohm_per_km": 0.206, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 200}
    pp.create_std_type(net, _4x150_Al_kbl, name="4x150_Al_kbl", element="line")
    _4x185_Al_kbl = {"r_ohm_per_km": 0.164, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 250}
    pp.create_std_type(net, _4x185_Al_kbl, name="4x185_Al_kbl", element="line")
    _4x240_Al_kbl = {"r_ohm_per_km": 0.125, "x_ohm_per_km": 0.088, "c_nf_per_km": 0, "max_i_ka": 250}
    pp.create_std_type(net, _4x240_Al_kbl, name="4x240_Al_kbl", element="line")
    _4x25_Al = {"r_ohm_per_km": 1.2, "x_ohm_per_km": 0.38, "c_nf_per_km": 0, "max_i_ka": 100}
    pp.create_std_type(net, _4x25_Al, name="4x25_Al", element="line")
    _4x25_ML = {"r_ohm_per_km": 1.2, "x_ohm_per_km": 0.078, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _4x25_ML, name="4x25_ML", element="line")
    _4x35_ML = {"r_ohm_per_km": 0.867, "x_ohm_per_km": 0.078, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _4x35_ML, name="4x35_ML", element="line")
    _4x50_Al_kbl = {"r_ohm_per_km": 0.641, "x_ohm_per_km": 0.093, "c_nf_per_km": 0, "max_i_ka": 100}
    pp.create_std_type(net, _4x50_Al_kbl, name="4x50_Al_kbl", element="line")
    _4x50_ML = {"r_ohm_per_km": 0.617, "x_ohm_per_km": 0.073, "c_nf_per_km": 0, "max_i_ka": 100}
    pp.create_std_type(net, _4x50_ML, name="4x50_ML", element="line")
    _4x95_Al_kbl = {"r_ohm_per_km": 0.32, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 125}
    pp.create_std_type(net, _4x95_Al_kbl, name="4x95_Al_kbl", element="line")
    # B4
    b0 = pp.create_bus(net, vn_kv=0.4, name=0)
    pp.create_switch(net, bus=trafo_lv_side, element=b0, et='b', type='CB', name='B7')
    b1 = pp.create_bus(net, vn_kv=0.4, name=1)
    pp.create_line(net, from_bus=b0, to_bus=b1, length_km=0.242, std_type="4x240_Al_kbl", name='0_1')
    b2 = pp.create_bus(net, vn_kv=0.4, name=2)
    pp.create_line(net, from_bus=b1, to_bus=b2, length_km=0.0138, std_type="4x240_Al_kbl", name='1_2')
    # 10686/4,3,2,8,7 kozul az egyik hianyzik, valoszinu a 7
    b3 = pp.create_bus(net, vn_kv=0.4, name=3)
    pp.create_line(net, from_bus=b2, to_bus=b3, length_km=0.0203, std_type="4x240_Al_kbl", name='2_3')
    pp.create_load(net, bus=b3, name=1047106539, p_mw=0.001)
    b4 = pp.create_bus(net, vn_kv=0.4, name=4)
    pp.create_line(net, from_bus=b3, to_bus=b4, length_km=0.0199, std_type="4x240_Al_kbl", name='3_4')
    pp.create_load(net, bus=b4, name=1047106540, p_mw=0.001)
    b5 = pp.create_bus(net, vn_kv=0.4, name=5)
    pp.create_line(net, from_bus=b4, to_bus=b5, length_km=0.0194, std_type="4x240_Al_kbl", name='4_5')
    pp.create_load(net, bus=b5, name=1047106542, p_mw=0.001)
    b6 = pp.create_bus(net, vn_kv=0.4, name=6)
    pp.create_line(net, from_bus=b5, to_bus=b6, length_km=0.0184, std_type="4x240_Al_kbl", name='5_6')
    pp.create_load(net, bus=b6, name=1047106532, p_mw=0.001)
    # B7
    b7 = pp.create_bus(net, vn_kv=0.4, name=7)
    pp.create_switch(net, bus=trafo_lv_side, element=b7, et='b', type='CB', name='B4')
    b8 = pp.create_bus(net, vn_kv=0.4, name=8)
    pp.create_line(net, from_bus=b7, to_bus=b8, length_km=0.0385, std_type="4x240_Al_kbl", name='7_8')
    b9 = pp.create_bus(net, vn_kv=0.4, name=9)
    pp.create_line(net, from_bus=b8, to_bus=b9, length_km=0.1315, std_type="4x95 Ml", name='8_9')
    pp.create_load(net, bus=b9, name=1047120523, p_mw=0.001)
    pp.create_load(net, bus=b9, name=1047120540, p_mw=0.001)
    pp.create_load(net, bus=b9, name=1047120545, p_mw=0.001)
    pp.create_load(net, bus=b9, name=1047120539, p_mw=0.001)
    b10 = pp.create_bus(net, vn_kv=0.4, name=10)
    pp.create_line(net, from_bus=b9, to_bus=b10, length_km=0.02847, std_type="4x95 Ml", name='9_10')
    pp.create_load(net, bus=b10, name=1047120546, p_mw=0.001)
    pp.create_load(net, bus=b10, name=1047120538, p_mw=0.001)
    pp.create_load(net, bus=b10, name=1047120544, p_mw=0.001)
    b11 = pp.create_bus(net, vn_kv=0.4, name=11)
    pp.create_line(net, from_bus=b10, to_bus=b11, length_km=0.02729, std_type="4x95 Ml", name='10_11')
    pp.create_load(net, bus=b11, name=1047120524, p_mw=0.001)
    pp.create_load(net, bus=b11, name=1047120536, p_mw=0.001)
    pp.create_load(net, bus=b11, name=1047120537, p_mw=0.001)
    pp.create_load(net, bus=b11, name=1047120525, p_mw=0.001)
    pp.create_load(net, bus=b11, name=1047120522, p_mw=0.001)
    b12 = pp.create_bus(net, vn_kv=0.4, name=12)
    pp.create_line(net, from_bus=b11, to_bus=b12, length_km=0.03228, std_type="4x95 Ml", name='11_12')
    pp.create_load(net, bus=b12, name=1047120526, p_mw=0.001)
    pp.create_load(net, bus=b12, name=1047120527, p_mw=0.001)
    pp.create_load(net, bus=b12, name=1047120535, p_mw=0.001)
    pp.create_load(net, bus=b12, name=1047120528, p_mw=0.001)
    pp.create_load(net, bus=b12, name=1047120534, p_mw=0.001)
    b13 = pp.create_bus(net, vn_kv=0.4, name=13)
    pp.create_line(net, from_bus=b12, to_bus=b13, length_km=0.03324, std_type="4x95 Ml", name='12_13')
    pp.create_load(net, bus=b13, name=1047120529, p_mw=0.001)
    pp.create_load(net, bus=b13, name=1047120533, p_mw=0.001)
    pp.create_load(net, bus=b13, name=1047120530, p_mw=0.001)
    pp.create_load(net, bus=b13, name=1047120542, p_mw=0.001)
    pp.create_load(net, bus=b13, name=1047120543, p_mw=0.001)
    pp.create_load(net, bus=b13, name=1047120547, p_mw=0.001)
    pp.create_load(net, bus=b13, name=1047120532, p_mw=0.001)
    b14 = pp.create_bus(net, vn_kv=0.4, name=14)
    pp.create_line(net, from_bus=b13, to_bus=b14, length_km=0.03166, std_type="4x95 Ml", name='13_14')
    pp.create_load(net, bus=b14, name=1049684173, p_mw=0.001)
    pp.create_load(net, bus=b14, name=1047120541, p_mw=0.001)
    # El jobbra a Selmeci utcara
    b15 = pp.create_bus(net, vn_kv=0.4, name=15)
    pp.create_line(net, from_bus=b14, to_bus=b15, length_km=0.04061, std_type="4x50_Al_kbl", name='14_15')
    pp.create_load(net, bus=b15, name=1047120570, p_mw=0.001)
    pp.create_load(net, bus=b15, name=1047120560, p_mw=0.001)
    b16 = pp.create_bus(net, vn_kv=0.4, name=16)
    pp.create_line(net, from_bus=b15, to_bus=b16, length_km=0.03288, std_type="4x50_Al_kbl", name='15_16')
    pp.create_load(net, bus=b16, name=1047120569, p_mw=0.001)
    pp.create_load(net, bus=b16, name=1047120565, p_mw=0.001)
    pp.create_load(net, bus=b16, name=1047120568, p_mw=0.001)
    pp.create_load(net, bus=b16, name=1047120566, p_mw=0.001)
    pp.create_load(net, bus=b16, name=1047120567, p_mw=0.001)
    # folytatas felfele a rozmaring utcan b14-rol
    b17 = pp.create_bus(net, vn_kv=0.4, name=17)
    pp.create_line(net, from_bus=b14, to_bus=b17, length_km=0.03179, std_type="4x95 Ml", name='14_17')
    pp.create_load(net, bus=b17, name=1079921621, p_mw=0.001)
    pp.create_load(net, bus=b17, name=1047120555, p_mw=0.001)
    pp.create_load(net, bus=b17, name=1047120548, p_mw=0.001)
    pp.create_load(net, bus=b17, name=1047120553, p_mw=0.001)
    pp.create_load(net, bus=b17, name=1047120556, p_mw=0.001)
    pp.create_load(net, bus=b17, name=1047120549, p_mw=0.001)
    b18 = pp.create_bus(net, vn_kv=0.4, name=18)
    pp.create_line(net, from_bus=b17, to_bus=b18, length_km=0.04030, std_type="4x95 Ml", name='17_18')
    pp.create_load(net, bus=b18, name=1047120557, p_mw=0.001)
    pp.create_load(net, bus=b18, name=1047120551, p_mw=0.001)
    pp.create_load(net, bus=b18, name=1047120558, p_mw=0.001)
    pp.create_load(net, bus=b18, name=1049674786, p_mw=0.001)
    pp.create_load(net, bus=b18, name=1047120552, p_mw=0.001)
    b19 = pp.create_bus(net, vn_kv=0.4, name=19)
    pp.create_line(net, from_bus=b18, to_bus=b19, length_km=0.04004, std_type="4x95 Ml", name='18_19')
    pp.create_load(net, bus=b19, name=1049677601, p_mw=0.001)
    pp.create_load(net, bus=b19, name=1047120564, p_mw=0.001)
    pp.create_load(net, bus=b19, name=1047120561, p_mw=0.001)
    pp.create_load(net, bus=b19, name=1047120562, p_mw=0.001)
    pp.create_load(net, bus=b19, name=1047120563, p_mw=0.001)
    pp.create_load(net, bus=b19, name=1047120550, p_mw=0.001)
    pp.create_load(net, bus=b19, name=1047120571, p_mw=0.001)
    pp.create_load(net, bus=b19, name=1047120572, p_mw=0.001)
    # el balra a pöltenberg utcába
    b20 = pp.create_bus(net, vn_kv=0.4, name=20)
    pp.create_line(net, from_bus=b19, to_bus=b20, length_km=0.02973, std_type="4x50_Al_kbl", name='19_20')
    pp.create_load(net, bus=b20, name=1047120490, p_mw=0.001)
    pp.create_load(net, bus=b20, name=1047120505, p_mw=0.001)
    pp.create_load(net, bus=b20, name=1047120571, p_mw=0.001)
    pp.create_load(net, bus=b20, name=1047120572, p_mw=0.001)
    b21 = pp.create_bus(net, vn_kv=0.4, name=21)
    pp.create_line(net, from_bus=b20, to_bus=b21, length_km=0.02944, std_type="4x50_Al_kbl", name='20_21')
    pp.create_load(net, bus=b21, name=1047120574, p_mw=0.001)
    pp.create_load(net, bus=b21, name=1047120580, p_mw=0.001)
    pp.create_load(net, bus=b21, name=1080112553, p_mw=0.001)
    pp.create_load(net, bus=b21, name=1047120573, p_mw=0.001)
    pp.create_load(net, bus=b21, name=1047120577, p_mw=0.001)
    b22 = pp.create_bus(net, vn_kv=0.4, name=22)
    pp.create_line(net, from_bus=b21, to_bus=b22, length_km=0.03366, std_type="4x50_Al_kbl", name='21_22')
    pp.create_load(net, bus=b22, name=1047120576, p_mw=0.001)
    pp.create_load(net, bus=b22, name=1047120578, p_mw=0.001)
    b23 = pp.create_bus(net, vn_kv=0.4, name=23)
    pp.create_line(net, from_bus=b22, to_bus=b23, length_km=0.02690, std_type="4x50_Al_kbl", name='22_23')
    pp.create_load(net, bus=b23, name=1047120579, p_mw=0.001)
    pp.create_load(net, bus=b23, name=1047118628, p_mw=0.001)
    # folytatas a rozmaring utcan b19-rol
    b24 = pp.create_bus(net, vn_kv=0.4, name=24)
    pp.create_line(net, from_bus=b19, to_bus=b24, length_km=0.03369, std_type="4x95 Ml", name='19_24')
    pp.create_load(net, bus=b24, name=1047120504, p_mw=0.001)
    pp.create_load(net, bus=b24, name=1047120503, p_mw=0.001)
    pp.create_load(net, bus=b24, name=1047120488, p_mw=0.001)
    pp.create_load(net, bus=b24, name=1047120501, p_mw=0.001)
    pp.create_load(net, bus=b24, name=1047120502, p_mw=0.001)
    pp.create_load(net, bus=b24, name=1047098477, p_mw=0.001)
    pp.create_load(net, bus=b24, name=1047120491, p_mw=0.001)
    pp.create_load(net, bus=b24, name=1047120492, p_mw=0.001)
    b25 = pp.create_bus(net, vn_kv=0.4, name=25)
    pp.create_line(net, from_bus=b24, to_bus=b25, length_km=0.03783, std_type="4x95 Ml", name='24_25')
    pp.create_load(net, bus=b25, name=1047120513, p_mw=0.001)
    pp.create_load(net, bus=b25, name=1047120518, p_mw=0.001)
    pp.create_load(net, bus=b25, name=1047120493, p_mw=0.001)
    pp.create_load(net, bus=b25, name=1047120499, p_mw=0.001)
    pp.create_load(net, bus=b25, name=1047120500, p_mw=0.001)
    pp.create_load(net, bus=b25, name=1047120506, p_mw=0.001)
    pp.create_load(net, bus=b25, name=1047120510, p_mw=0.001)
    pp.create_load(net, bus=b25, name=1047120519, p_mw=0.001)
    b26 = pp.create_bus(net, vn_kv=0.4, name=26)
    pp.create_line(net, from_bus=b25, to_bus=b26, length_km=0.03495, std_type="4x95 Ml", name='25_26')
    pp.create_load(net, bus=b26, name=1080110238, p_mw=0.001)
    pp.create_load(net, bus=b26, name=1047120507, p_mw=0.001)
    pp.create_load(net, bus=b26, name=1047120508, p_mw=0.001)
    b27 = pp.create_bus(net, vn_kv=0.4, name=27)
    pp.create_line(net, from_bus=b26, to_bus=b27, length_km=0.03413, std_type="4x95 Ml", name='26_27')
    pp.create_load(net, bus=b27, name=1047120515, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047096012, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120497, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120496, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120511, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120517, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120521, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120489, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120520, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120512, p_mw=0.001)
    pp.create_load(net, bus=b27, name=1047120498, p_mw=0.001)
    b28 = pp.create_bus(net, vn_kv=0.4, name=28)
    pp.create_line(net, from_bus=b27, to_bus=b28, length_km=0.02867, std_type="4x95 Ml", name='27_28')
    pp.create_load(net, bus=b28, name=1047120514, p_mw=0.001)
    pp.create_load(net, bus=b28, name=1047120495, p_mw=0.001)
    b29 = pp.create_bus(net, vn_kv=0.4, name=29)
    pp.create_line(net, from_bus=b28, to_bus=b29, length_km=0.03369, std_type="4x95 Ml", name='28_29')
    pp.create_load(net, bus=b29, name=1047120494, p_mw=0.001)
    b30 = pp.create_bus(net, vn_kv=0.4, name=30)
    pp.create_line(net, from_bus=b29, to_bus=b30, length_km=0.02742, std_type="4x95 Ml", name='29_30')
    pp.create_load(net, bus=b30, name=1047120509, p_mw=0.001)
    # B9
    b31 = pp.create_bus(net, vn_kv=0.4, name=31)
    pp.create_switch(net, bus=trafo_lv_side, element=b31, et='b', type='CB', name='B9')
    b32 = pp.create_bus(net, vn_kv=0.4, name=32)
    pp.create_line(net, from_bus=b31, to_bus=b32, length_km=0.1415, std_type="4x240_Al_kbl", name='31_32')
    pp.create_load(net, bus=b32, name=1047106552, p_mw=0.001)
    pp.create_load(net, bus=b32, name=1047107484, p_mw=0.001)
    b33 = pp.create_bus(net, vn_kv=0.4, name=33)
    pp.create_line(net, from_bus=b32, to_bus=b33, length_km=0.21314, std_type="4x240_Al_kbl", name='32_33')
    pp.create_load(net, bus=b33, name=1047120787, p_mw=0.001)
    # B24
    b34 = pp.create_bus(net, vn_kv=0.4, name=34)
    pp.create_switch(net, bus=trafo_lv_side, element=b34, et='b', type='CB', name='B24')
    b35 = pp.create_bus(net, vn_kv=0.4, name=35)
    pp.create_line(net, from_bus=b34, to_bus=b35, length_km=0.243, std_type="4x240_Al_kbl", name='34_35')
    pp.create_load(net, bus=b35, name=1080267900, p_mw=0.001)
    b36 = pp.create_bus(net, vn_kv=0.4, name=36)
    pp.create_line(net, from_bus=b35, to_bus=b36, length_km=0.011, std_type="4x240_Al_kbl", name='35_36')
    pp.create_load(net, bus=b36, name=1080267901, p_mw=0.001)
    pp.create_load(net, bus=b36, name=1080269777, p_mw=0.001)
    pp.create_load(net, bus=b36, name=1080267899, p_mw=0.001)
    b37 = pp.create_bus(net, vn_kv=0.4, name=37)
    pp.create_line(net, from_bus=b36, to_bus=b37, length_km=0.056, std_type="4x240_Al_kbl", name='36_37')
    pp.create_load(net, bus=b37, name=1080267911, p_mw=0.001)
    pp.create_load(net, bus=b37, name=1080267910, p_mw=0.001)
    pp.create_load(net, bus=b37, name=1080269693, p_mw=0.001)
    # egy fogyaszto hianyzik 10687/5 hrsz-rol
    # B6
    b38 = pp.create_bus(net, vn_kv=0.4, name=38)
    pp.create_switch(net, bus=trafo_lv_side, element=b38, et='b', type='CB', name='B6')
    b39 = pp.create_bus(net, vn_kv=0.4, name=39)
    pp.create_line(net, from_bus=b38, to_bus=b39, length_km=0.0221, std_type="4x240_Al_kbl", name='38_39')
    b40 = pp.create_bus(net, vn_kv=0.4, name=40)
    pp.create_line(net, from_bus=b39, to_bus=b40, length_km=0.0231, std_type="4x95 Ml", name='39_40')
    pp.create_load(net, bus=b40, name=1047120481, p_mw=0.001)
    pp.create_load(net, bus=b40, name=1047120480, p_mw=0.001)
    b41 = pp.create_bus(net, vn_kv=0.4, name=41)
    pp.create_line(net, from_bus=b40, to_bus=b41, length_km=0.3636, std_type="4x95 Ml", name='40_41')
    pp.create_load(net, bus=b41, name=1047097973, p_mw=0.001)
    pp.create_load(net, bus=b41, name=1047097982, p_mw=0.001)
    pp.create_load(net, bus=b41, name=1047097986, p_mw=0.001)
    pp.create_load(net, bus=b41, name=1080346221, p_mw=0.001)
    b42 = pp.create_bus(net, vn_kv=0.4, name=42)
    pp.create_line(net, from_bus=b41, to_bus=b42, length_km=0.0303, std_type="4x95 Ml", name='41_42')
    pp.create_load(net, bus=b42, name=1047098017, p_mw=0.001)
    pp.create_load(net, bus=b42, name=1047097975, p_mw=0.001)
    pp.create_load(net, bus=b42, name=1047097976, p_mw=0.001)
    b43 = pp.create_bus(net, vn_kv=0.4, name=43)
    pp.create_line(net, from_bus=b42, to_bus=b43, length_km=0.0305, std_type="4x95 Ml", name='42_43')
    pp.create_load(net, bus=b43, name=1047098015, p_mw=0.001)
    pp.create_load(net, bus=b43, name=1047098016, p_mw=0.001)
    pp.create_load(net, bus=b43, name=1047097994, p_mw=0.001)
    pp.create_load(net, bus=b43, name=1047097987, p_mw=0.001)
    b44 = pp.create_bus(net, vn_kv=0.4, name=44)
    pp.create_line(net, from_bus=b43, to_bus=b44, length_km=0.0295, std_type="4x95 Ml", name='43_44')
    pp.create_load(net, bus=b44, name=1047097967, p_mw=0.001)
    pp.create_load(net, bus=b44, name=1047097981, p_mw=0.001)
    pp.create_load(net, bus=b44, name=1047097995, p_mw=0.001)
    pp.create_load(net, bus=b44, name=1047098014, p_mw=0.001)
    pp.create_load(net, bus=b44, name=1047097985, p_mw=0.001)
    pp.create_load(net, bus=b44, name=1079859076, p_mw=0.001)
    b45 = pp.create_bus(net, vn_kv=0.4, name=45)
    pp.create_line(net, from_bus=b44, to_bus=b45, length_km=0.0296, std_type="4x95 Ml", name='44_45')
    pp.create_load(net, bus=b45, name=1047097996, p_mw=0.001)
    pp.create_load(net, bus=b45, name=1047097983, p_mw=0.001)
    pp.create_load(net, bus=b45, name=1047097990, p_mw=0.001)
    pp.create_load(net, bus=b45, name=1047097997, p_mw=0.001)
    pp.create_load(net, bus=b45, name=1047097977, p_mw=0.001)
    b46 = pp.create_bus(net, vn_kv=0.4, name=46)
    pp.create_line(net, from_bus=b45, to_bus=b46, length_km=0.0303, std_type="4x95 Ml", name='45_46')
    pp.create_load(net, bus=b46, name=1047098013, p_mw=0.001)
    pp.create_load(net, bus=b46, name=1047098012, p_mw=0.001)
    pp.create_load(net, bus=b46, name=1047097969, p_mw=0.001)
    b47 = pp.create_bus(net, vn_kv=0.4, name=47)
    pp.create_line(net, from_bus=b46, to_bus=b47, length_km=0.0258, std_type="4x95 Ml", name='46_47')
    pp.create_load(net, bus=b47, name=1047097984, p_mw=0.001)
    pp.create_load(net, bus=b47, name=1047097972, p_mw=0.001)
    pp.create_load(net, bus=b47, name=1047098011, p_mw=0.001)
    pp.create_load(net, bus=b47, name=1047097978, p_mw=0.001)
    pp.create_load(net, bus=b47, name=1079872699, p_mw=0.001)
    pp.create_load(net, bus=b47, name=1047097992, p_mw=0.001)
    b48 = pp.create_bus(net, vn_kv=0.4, name=48)
    pp.create_line(net, from_bus=b47, to_bus=b48, length_km=0.0288, std_type="4x95 Ml", name='47_48')
    pp.create_load(net, bus=b48, name=1047098009, p_mw=0.001)
    pp.create_load(net, bus=b48, name=1047098008, p_mw=0.001)
    pp.create_load(net, bus=b48, name=1047098018, p_mw=0.001)
    pp.create_load(net, bus=b48, name=1047097999, p_mw=0.001)
    pp.create_load(net, bus=b48, name=1047098006, p_mw=0.001)
    pp.create_load(net, bus=b48, name=1047098007, p_mw=0.001)
    pp.create_load(net, bus=b48, name=1047098001, p_mw=0.001)
    pp.create_load(net, bus=b48, name=1047098000, p_mw=0.001)
    b49 = pp.create_bus(net, vn_kv=0.4, name=49)
    pp.create_line(net, from_bus=b48, to_bus=b49, length_km=0.0318, std_type="4x95 Ml", name='48_49')
    pp.create_load(net, bus=b49, name=1047098005, p_mw=0.001)
    pp.create_load(net, bus=b49, name=1047097988, p_mw=0.001)
    pp.create_load(net, bus=b49, name=1047098002, p_mw=0.001)
    # B5
    b50 = pp.create_bus(net, vn_kv=0.4, name=50)
    pp.create_switch(net, bus=trafo_lv_side, element=b50, et='b', type='CB', name='B5')
    b51 = pp.create_bus(net, vn_kv=0.4, name=51)
    pp.create_line(net, from_bus=b50, to_bus=b51, length_km=0.0462, std_type="4x95 Al", name='50_51')
    pp.create_load(net, bus=b51, name=1047120587, p_mw=0.001)
    b52 = pp.create_bus(net, vn_kv=0.4, name=52)
    pp.create_line(net, from_bus=b51, to_bus=b52, length_km=0.0347, std_type="4x95 Al", name='51_52')
    pp.create_load(net, bus=b52, name=1047120588, p_mw=0.001)
    pp.create_load(net, bus=b52, name=1047120582, p_mw=0.001)
    pp.create_load(net, bus=b52, name=1047120586, p_mw=0.001)
    b53 = pp.create_bus(net, vn_kv=0.4, name=53)
    pp.create_line(net, from_bus=b52, to_bus=b53, length_km=0.0287, std_type="4x95 Al", name='52_53')
    pp.create_load(net, bus=b53, name=1047120583, p_mw=0.001)
    pp.create_load(net, bus=b53, name=1047120585, p_mw=0.001)
    b54 = pp.create_bus(net, vn_kv=0.4, name=54)
    pp.create_line(net, from_bus=b53, to_bus=b54, length_km=0.0583, std_type="4x95 Al", name='53_54')
    pp.create_load(net, bus=b54, name=1047120589, p_mw=0.001)
    pp.create_load(net, bus=b54, name=1047120590, p_mw=0.001)
    b55 = pp.create_bus(net, vn_kv=0.4, name=55)
    pp.create_line(net, from_bus=b54, to_bus=b55, length_km=0.036, std_type="4x95 Al", name='54_55')
    pp.create_load(net, bus=b55, name=1047120591, p_mw=0.001)
    # 10923 hrsz-rol hianyzik egy fogyaszto
    b56 = pp.create_bus(net, vn_kv=0.4, name=56)
    pp.create_line(net, from_bus=b55, to_bus=b56, length_km=0.0334, std_type="4x95 Al", name='55_56')
    # innen balra fel
    b57 = pp.create_bus(net, vn_kv=0.4, name=57)
    pp.create_line(net, from_bus=b56, to_bus=b57, length_km=0.0304, std_type="4x95 Ml", name='56_57')
    pp.create_load(net, bus=b57, name=1047120609, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047120613, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047120614, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047120606, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047120615, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047120616, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047095788, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047097970, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047098024, p_mw=0.001)
    pp.create_load(net, bus=b57, name=1047120617, p_mw=0.001)
    b58 = pp.create_bus(net, vn_kv=0.4, name=58)
    pp.create_line(net, from_bus=b57, to_bus=b58, length_km=0.0309, std_type="4x95 Ml", name='57_58')
    pp.create_load(net, bus=b58, name=1047098021, p_mw=0.001)
    pp.create_load(net, bus=b58, name=1047120610, p_mw=0.001)
    pp.create_load(net, bus=b58, name=1047120619, p_mw=0.001)
    pp.create_load(net, bus=b58, name=1047098023, p_mw=0.001)
    pp.create_load(net, bus=b58, name=1047120618, p_mw=0.001)
    pp.create_load(net, bus=b58, name=1047098022, p_mw=0.001)
    b59 = pp.create_bus(net, vn_kv=0.4, name=59)
    pp.create_line(net, from_bus=b58, to_bus=b59, length_km=0.0304, std_type="4x95 Ml", name='58_59')
    pp.create_load(net, bus=b59, name=1047120611, p_mw=0.001)
    pp.create_load(net, bus=b59, name=1047098020, p_mw=0.001)
    pp.create_load(net, bus=b59, name=1047120621, p_mw=0.001)
    b60 = pp.create_bus(net, vn_kv=0.4, name=60)
    pp.create_line(net, from_bus=b59, to_bus=b60, length_km=0.0317, std_type="4x95 Ml", name='59_60')
    pp.create_load(net, bus=b60, name=1047120604, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120601, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120598, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120608, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120607, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120605, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120612, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120603, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120599, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120600, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120602, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047120620, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047097971, p_mw=0.001)
    pp.create_load(net, bus=b60, name=1047097980, p_mw=0.001)
    # az elozo elagazastol tovabb egyenesen
    b61 = pp.create_bus(net, vn_kv=0.4, name=61)
    pp.create_line(net, from_bus=b56, to_bus=b61, length_km=0.0321, std_type="4x25_ML", name='56_61')
    pp.create_load(net, bus=b61, name=1047120592, p_mw=0.001)
    b62 = pp.create_bus(net, vn_kv=0.4, name=62)
    pp.create_line(net, from_bus=b61, to_bus=b62, length_km=0.0325, std_type="4x25_ML", name='61_62')
    pp.create_load(net, bus=b62, name=1047120596, p_mw=0.001)
    pp.create_load(net, bus=b62, name=1047120595, p_mw=0.001)
    b63 = pp.create_bus(net, vn_kv=0.4, name=63)
    pp.create_line(net, from_bus=b62, to_bus=b63, length_km=0.0332, std_type="4x25_ML", name='62_63')
    pp.create_load(net, bus=b63, name=1047120584, p_mw=0.001)
    pp.create_load(net, bus=b63, name=1047096013, p_mw=0.001)
    pp.create_load(net, bus=b63, name=1047120597, p_mw=0.001)
    b64 = pp.create_bus(net, vn_kv=0.4, name=64)
    pp.create_line(net, from_bus=b63, to_bus=b64, length_km=0.0286, std_type="4x25_ML", name='63_64')
    pp.create_load(net, bus=b64, name=1047120594, p_mw=0.001)
    b65 = pp.create_bus(net, vn_kv=0.4, name=65)
    pp.create_line(net, from_bus=b64, to_bus=b65, length_km=0.0332, std_type="4x25_ML", name='64_65')
    pp.create_load(net, bus=b65, name=1047111765, p_mw=0.001)
    # hianyzik egy fogyaszto a 10984/1 hrsz-rol
    # B8
    b66 = pp.create_bus(net, vn_kv=0.4, name=66)
    pp.create_switch(net, bus=trafo_lv_side, element=b66, et='b', type='CB', name='B8')
    b67 = pp.create_bus(net, vn_kv=0.4, name=67)
    pp.create_line(net, from_bus=b66, to_bus=b67, length_km=0.0211, std_type="4x150_Al_kbl", name='66_67')
    pp.create_load(net, bus=b67, name=1047118667, p_mw=0.001)
    pp.create_load(net, bus=b67, name=1047120487, p_mw=0.001)
    pp.create_load(net, bus=b67, name=1047120486, p_mw=0.001)
    pp.create_load(net, bus=b67, name=1047118673, p_mw=0.001)
    b68 = pp.create_bus(net, vn_kv=0.4, name=68)
    pp.create_line(net, from_bus=b67, to_bus=b68, length_km=0.02869, std_type="4x50_ML", name='67_68')
    pp.create_load(net, bus=b68, name=1047118668, p_mw=0.001)
    pp.create_load(net, bus=b68, name=1047118670, p_mw=0.001)
    b69 = pp.create_bus(net, vn_kv=0.4, name=69)
    pp.create_line(net, from_bus=b68, to_bus=b69, length_km=0.02693, std_type="4x50_ML", name='68_69')
    pp.create_load(net, bus=b69, name=1047118675, p_mw=0.001)
    pp.create_load(net, bus=b69, name=1047118669, p_mw=0.001)
    pp.create_load(net, bus=b69, name=1047118676, p_mw=0.001)
    b70 = pp.create_bus(net, vn_kv=0.4, name=70)
    pp.create_line(net, from_bus=b69, to_bus=b70, length_km=0.02984, std_type="4x50_ML", name='69_70')
    pp.create_load(net, bus=b70, name=1047118677, p_mw=0.001)
    b71 = pp.create_bus(net, vn_kv=0.4, name=71)
    pp.create_line(net, from_bus=b70, to_bus=b71, length_km=0.0525, std_type="4x50 Al", name='70_71')
    pp.create_load(net, bus=b71, name=1049674847, p_mw=0.001)
    b72 = pp.create_bus(net, vn_kv=0.4, name=72)
    pp.create_line(net, from_bus=b71, to_bus=b72, length_km=0.02911, std_type="4x50 Al", name='71_72')
    # jobbra le
    b73 = pp.create_bus(net, vn_kv=0.4, name=73)
    pp.create_line(net, from_bus=b72, to_bus=b73, length_km=0.02275, std_type="4x50 Al", name='72_73')
    pp.create_load(net, bus=b73, name=1047118654, p_mw=0.001)
    pp.create_load(net, bus=b73, name=1047118651, p_mw=0.001)
    b74 = pp.create_bus(net, vn_kv=0.4, name=74)
    pp.create_line(net, from_bus=b73, to_bus=b74, length_km=0.02121, std_type="4x50 Al", name='73_74')
    pp.create_load(net, bus=b74, name=1047118655, p_mw=0.001)
    pp.create_load(net, bus=b74, name=1047118653, p_mw=0.001)
    # egy hianyzik, vagy a 10549 hrsz vagy a 10550 hrsz
    # tovabb felfele a b72-rol
    b75 = pp.create_bus(net, vn_kv=0.4, name=75)
    pp.create_line(net, from_bus=b72, to_bus=b75, length_km=0.02589, std_type="4x50 Al", name='72_75')
    pp.create_load(net, bus=b75, name=1047118649, p_mw=0.001)
    pp.create_load(net, bus=b75, name=1047118648, p_mw=0.001)
    pp.create_load(net, bus=b75, name=1047118650, p_mw=0.001)
    b76 = pp.create_bus(net, vn_kv=0.4, name=76)
    pp.create_line(net, from_bus=b75, to_bus=b76, length_km=0.02790, std_type="4x50 Al", name='75_76')
    pp.create_load(net, bus=b76, name=1047118645, p_mw=0.001)
    pp.create_load(net, bus=b76, name=1047118647, p_mw=0.001)
    pp.create_load(net, bus=b76, name=1047118646, p_mw=0.001)
    # B2
    b77 = pp.create_bus(net, vn_kv=0.4, name=77)
    pp.create_switch(net, bus=trafo_lv_side, element=b77, et='b', type='CB', name='B2')
    b78 = pp.create_bus(net, vn_kv=0.4, name=78)
    pp.create_line(net, from_bus=b77, to_bus=b78, length_km=0.1388, std_type="4x150_Al_kbl", name='77_78')
    # haladva tovabb egy fogyasztoert
    b79 = pp.create_bus(net, vn_kv=0.4, name=79)
    pp.create_line(net, from_bus=b78, to_bus=b79, length_km=0.0577, std_type="4x150_Al_kbl", name='78_79')
    pp.create_load(net, bus=b79, name=1047118671, p_mw=0.001)
    # lefele folytatas b78-rol
    b80 = pp.create_bus(net, vn_kv=0.4, name=80)
    pp.create_line(net, from_bus=b78, to_bus=b80, length_km=0.02806, std_type="4x240_Al_kbl", name='78_80')
    pp.create_load(net, bus=b80, name=1047118665, p_mw=0.001)
    # be a fogyasztokhoz
    b81 = pp.create_bus(net, vn_kv=0.4, name=81)
    pp.create_line(net, from_bus=b80, to_bus=b81, length_km=0.015, std_type="4x50_Al_kbl", name='80_81')
    pp.create_load(net, bus=b81, name=1047118666, p_mw=0.001)
    b82 = pp.create_bus(net, vn_kv=0.4, name=82)
    pp.create_line(net, from_bus=b81, to_bus=b82, length_km=0.0085, std_type="4x50_Al_kbl", name='81_82')
    pp.create_load(net, bus=b82, name=1047118664, p_mw=0.001)
    b83 = pp.create_bus(net, vn_kv=0.4, name=83)
    pp.create_line(net, from_bus=b82, to_bus=b83, length_km=0.0081, std_type="4x50_Al_kbl", name='82_83')
    pp.create_load(net, bus=b83, name=1047106544, p_mw=0.001)
    # folytatas tovabb lefele b80-rol
    b84 = pp.create_bus(net, vn_kv=0.4, name=84)
    pp.create_line(net, from_bus=b80, to_bus=b84, length_km=0.017, std_type="4x240_Al_kbl", name='80_84')
    pp.create_load(net, bus=b84, name=1047106551, p_mw=0.001)
    pp.create_load(net, bus=b84, name=1047106553, p_mw=0.001)
    b85 = pp.create_bus(net, vn_kv=0.4, name=85)
    pp.create_line(net, from_bus=b84, to_bus=b85, length_km=0.0102, std_type="4x240_Al_kbl", name='84_85')
    pp.create_load(net, bus=b85, name=1047106563, p_mw=0.001)
    pp.create_load(net, bus=b85, name=1047106565, p_mw=0.001)
    pp.create_load(net, bus=b85, name=1047106564, p_mw=0.001)
    pp.create_load(net, bus=b85, name=1047106566, p_mw=0.001)
    pp.create_load(net, bus=b85, name=1047106567, p_mw=0.001)
    b86 = pp.create_bus(net, vn_kv=0.4, name=86)
    pp.create_line(net, from_bus=b85, to_bus=b86, length_km=0.022, std_type="4x240_Al_kbl", name='85_86')
    pp.create_load(net, bus=b86, name=1047106569, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106574, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106575, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106570, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106573, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106576, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106568, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106571, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106577, p_mw=0.001)
    pp.create_load(net, bus=b86, name=1047106572, p_mw=0.001)
    b87 = pp.create_bus(net, vn_kv=0.4, name=87)
    pp.create_line(net, from_bus=b86, to_bus=b87, length_km=0.0179, std_type="4x240_Al_kbl", name='86_87')
    pp.create_load(net, bus=b87, name=1047106578, p_mw=0.001)
    b88 = pp.create_bus(net, vn_kv=0.4, name=88)
    pp.create_line(net, from_bus=b87, to_bus=b88, length_km=0.035, std_type="4x240_Al_kbl", name='87_88')
    pp.create_load(net, bus=b88, name=1047106593, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106594, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106596, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106597, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106585, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106587, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106592, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106595, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106581, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106582, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106583, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106586, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106591, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106584, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106588, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106589, p_mw=0.001)
    pp.create_load(net, bus=b88, name=1047106590, p_mw=0.001)
    # B3
    b89 = pp.create_bus(net, vn_kv=0.4, name=89)
    pp.create_switch(net, bus=trafo_lv_side, element=b0, et='b', type='CB', name='B3')
    b90 = pp.create_bus(net, vn_kv=0.4, name=90)
    pp.create_line(net, from_bus=b89, to_bus=b90, length_km=0.0326, std_type="4x240_Al_kbl", name='89_90')
    pp.create_load(net, bus=b90, name=1047118611, p_mw=0.001)
    b91 = pp.create_bus(net, vn_kv=0.4, name=91)
    pp.create_line(net, from_bus=b90, to_bus=b91, length_km=0.0280, std_type="4x240_Al_kbl", name='90_91')
    pp.create_load(net, bus=b91, name=1047118638, p_mw=0.001)
    pp.create_load(net, bus=b91, name=1047118643, p_mw=0.001)
    pp.create_load(net, bus=b91, name=1047118637, p_mw=0.001)
    # elagazas lefele
    b92 = pp.create_bus(net, vn_kv=0.4, name=92)
    pp.create_line(net, from_bus=b91, to_bus=b92, length_km=0.0292, std_type="4x95 Al", name='91_92')
    pp.create_load(net, bus=b92, name=1047118639, p_mw=0.001)
    pp.create_load(net, bus=b92, name=1047118640, p_mw=0.001)
    pp.create_load(net, bus=b92, name=1047118641, p_mw=0.001)
    # elozo elagazastol elagazas felfele
    b93 = pp.create_bus(net, vn_kv=0.4, name=93)
    pp.create_line(net, from_bus=b91, to_bus=b93, length_km=0.0304, std_type="4x95 Al", name='91_93')
    pp.create_load(net, bus=b93, name=1047118609, p_mw=0.001)
    pp.create_load(net, bus=b93, name=1047095993, p_mw=0.001)
    pp.create_load(net, bus=b93, name=1047118616, p_mw=0.001)
    pp.create_load(net, bus=b93, name=1047118617, p_mw=0.001)
    b94 = pp.create_bus(net, vn_kv=0.4, name=94)
    pp.create_line(net, from_bus=b93, to_bus=b94, length_km=0.0314, std_type="4x95 Al", name='93_94')
    pp.create_load(net, bus=b94, name=1047120479, p_mw=0.001)
    pp.create_load(net, bus=b94, name=1047120483, p_mw=0.001)
    pp.create_load(net, bus=b94, name=1047118619, p_mw=0.001)
    pp.create_load(net, bus=b94, name=1047120477, p_mw=0.001)
    b95 = pp.create_bus(net, vn_kv=0.4, name=95)
    pp.create_line(net, from_bus=b94, to_bus=b95, length_km=0.0322, std_type="4x95 Al", name='94_95')
    pp.create_load(net, bus=b95, name=1047118610, p_mw=0.001)
    pp.create_load(net, bus=b95, name=1047120478, p_mw=0.001)
    pp.create_load(net, bus=b95, name=1047118613, p_mw=0.001)
    pp.create_load(net, bus=b95, name=1047120469, p_mw=0.001)
    pp.create_load(net, bus=b95, name=1047118624, p_mw=0.001)
    b96 = pp.create_bus(net, vn_kv=0.4, name=96)
    pp.create_line(net, from_bus=b95, to_bus=b96, length_km=0.0325, std_type="4x95 Al", name='95_96')
    pp.create_load(net, bus=b96, name=1047120476, p_mw=0.001)
    pp.create_load(net, bus=b96, name=1047120474, p_mw=0.001)
    pp.create_load(net, bus=b96, name=1047120475, p_mw=0.001)
    pp.create_load(net, bus=b96, name=1047118618, p_mw=0.001)
    b97 = pp.create_bus(net, vn_kv=0.4, name=97)
    pp.create_line(net, from_bus=b96, to_bus=b97, length_km=0.0277, std_type="4x95 Al", name='96_97')
    pp.create_load(net, bus=b97, name=1047118614, p_mw=0.001)
    pp.create_load(net, bus=b97, name=1047120473, p_mw=0.001)
    pp.create_load(net, bus=b97, name=1047120472, p_mw=0.001)
    pp.create_load(net, bus=b97, name=1047120482, p_mw=0.001)
    pp.create_load(net, bus=b97, name=1047120471, p_mw=0.001)
    pp.create_load(net, bus=b97, name=1047120470, p_mw=0.001)
    pp.create_load(net, bus=b97, name=1047118622, p_mw=0.001)
    pp.create_load(net, bus=b97, name=1047118623, p_mw=0.001)
    b98 = pp.create_bus(net, vn_kv=0.4, name=98)
    pp.create_line(net, from_bus=b97, to_bus=b98, length_km=0.0282, std_type="4x95 Al", name='97_98')
    pp.create_load(net, bus=b98, name=1047118615, p_mw=0.001)
    pp.create_load(net, bus=b98, name=1047118612, p_mw=0.001)
    pp.create_load(net, bus=b98, name=1080200204, p_mw=0.001)
    b99 = pp.create_bus(net, vn_kv=0.4, name=99)
    pp.create_line(net, from_bus=b98, to_bus=b99, length_km=0.0288, std_type="4x95 Al", name='98_99')
    # hianyzik egy fogyaszto hrsz 10687/3
    # innen leagazas felfele
    b100 = pp.create_bus(net, vn_kv=0.4, name=100)
    pp.create_line(net, from_bus=b99, to_bus=b100, length_km=0.0306, std_type="4x95 Al", name='99_100')
    pp.create_load(net, bus=b100, name=1047118603, p_mw=0.001)
    pp.create_load(net, bus=b100, name=1047106533, p_mw=0.001)
    pp.create_load(net, bus=b100, name=1047120484, p_mw=0.001)
    b101 = pp.create_bus(net, vn_kv=0.4, name=101)
    pp.create_line(net, from_bus=b100, to_bus=b101, length_km=0.0302, std_type="4x95 Al", name='100_101')
    pp.create_load(net, bus=b101, name=1047106536, p_mw=0.001)
    pp.create_load(net, bus=b101, name=1047118625, p_mw=0.001)
    b102 = pp.create_bus(net, vn_kv=0.4, name=102)
    pp.create_line(net, from_bus=b101, to_bus=b102, length_km=0.0312, std_type="4x95 Al", name='101_102')
    pp.create_load(net, bus=b102, name=1047118630, p_mw=0.001)
    pp.create_load(net, bus=b102, name=1047118631, p_mw=0.001)
    pp.create_load(net, bus=b102, name=1047118629, p_mw=0.001)
    pp.create_load(net, bus=b102, name=1047118633, p_mw=0.001)
    pp.create_load(net, bus=b102, name=1047118634, p_mw=0.001)
    pp.create_load(net, bus=b102, name=1047118632, p_mw=0.001)
    b103 = pp.create_bus(net, vn_kv=0.4, name=103)
    pp.create_line(net, from_bus=b102, to_bus=b103, length_km=0.0289, std_type="4x95 Al", name='102_103')
    pp.create_load(net, bus=b103, name=1047118635, p_mw=0.001)
    pp.create_load(net, bus=b103, name=1047118636, p_mw=0.001)
    b104 = pp.create_bus(net, vn_kv=0.4, name=104)
    pp.create_line(net, from_bus=b103, to_bus=b104, length_km=0.0301, std_type="4x95 Al", name='103_104')
    pp.create_load(net, bus=b104, name=1047117552, p_mw=0.001)
    # innen eszaki iranyban pedig tobb fogyaszto is hianyzik
    # hrsz-ek: 10678, 10676, 10832, 10675, 10674, 10833/1, 10836, 10837, 10672, 10839/2, 10840, 10844/1, 10844/4
    # az elozo elagazastol jobbra haladva
    b105 = pp.create_bus(net, vn_kv=0.4, name=105)
    pp.create_line(net, from_bus=b99, to_bus=b105, length_km=0.0166, std_type="4x95 Ml", name='99_105')
    b106 = pp.create_bus(net, vn_kv=0.4, name=106)
    pp.create_line(net, from_bus=b105, to_bus=b106, length_km=0.0238, std_type="4x50 Al", name='105_106')
    pp.create_load(net, bus=b106, name=1047097962, p_mw=0.001)
    pp.create_load(net, bus=b106, name=1047097963, p_mw=0.001)
    pp.create_load(net, bus=b106, name=1047106537, p_mw=0.001)
    pp.create_load(net, bus=b106, name=1047106538, p_mw=0.001)
    pp.create_load(net, bus=b106, name=1047095873, p_mw=0.001)
    pp.create_load(net, bus=b106, name=1047097953, p_mw=0.001)
    b107 = pp.create_bus(net, vn_kv=0.4, name=107)
    pp.create_line(net, from_bus=b106, to_bus=b107, length_km=0.0269, std_type="4x50 Al", name='106_107')
    pp.create_load(net, bus=b107, name=1047097955, p_mw=0.001)
    # innen lehet hianyzik egy fogyaszto hrsz 10808
    b108 = pp.create_bus(net, vn_kv=0.4, name=108)
    pp.create_line(net, from_bus=b107, to_bus=b108, length_km=0.0262, std_type="4x50 Al", name='107_108')
    pp.create_load(net, bus=b108, name=1047097954, p_mw=0.001)
    pp.create_load(net, bus=b108, name=1047097961, p_mw=0.001)
    pp.create_load(net, bus=b108, name=1047097960, p_mw=0.001)
    pp.create_load(net, bus=b108, name=1047097959, p_mw=0.001)
    pp.create_load(net, bus=b108, name=1047097966, p_mw=0.001)
    b109 = pp.create_bus(net, vn_kv=0.4, name=109)
    pp.create_line(net, from_bus=b108, to_bus=b109, length_km=0.0264, std_type="4x50 Al", name='108_109')
    pp.create_load(net, bus=b109, name=1047097964, p_mw=0.001)
    pp.create_load(net, bus=b109, name=1047097965, p_mw=0.001)
    pp.create_load(net, bus=b109, name=1047097957, p_mw=0.001)
    pp.create_load(net, bus=b109, name=1047097956, p_mw=0.001)
    pp.create_load(net, bus=b109, name=1047097958, p_mw=0.001)
    # B1
    b110 = pp.create_bus(net, vn_kv=0.4, name=110)
    pp.create_switch(net, bus=trafo_lv_side, element=b110, et='b', type='CB', name='B1')
    b111 = pp.create_bus(net, vn_kv=0.4, name=111)
    pp.create_line(net, from_bus=b110, to_bus=b111, length_km=0.1388, std_type="3x240_Al_kbl_plus_120_Al_kbl",
                   name='110_111')
    pp.create_load(net, bus=b111, name=1047106550, p_mw=0.001)
    b112 = pp.create_bus(net, vn_kv=0.4, name=112)
    pp.create_line(net, from_bus=b111, to_bus=b112, length_km=0.0112, std_type="3x240_Al_kbl_plus_120_Al_kbl",
                   name='111_112')
    pp.create_load(net, bus=b112, name=1047118674, p_mw=0.001)
    b113 = pp.create_bus(net, vn_kv=0.4, name=113)
    pp.create_line(net, from_bus=b112, to_bus=b113, length_km=0.0182, std_type="3x240_Al_kbl_plus_120_Al_kbl",
                   name='112_113')
    pp.create_load(net, bus=b113, name=1047106545, p_mw=0.001)
    pp.create_load(net, bus=b113, name=1047106546, p_mw=0.001)
    b114 = pp.create_bus(net, vn_kv=0.4, name=114)
    pp.create_line(net, from_bus=b113, to_bus=b114, length_km=0.035, std_type="3x240_Al_kbl_plus_120_Al_kbl",
                   name='113_114')
    pp.create_load(net, bus=b114, name=1047118678, p_mw=0.001)
    b115 = pp.create_bus(net, vn_kv=0.4, name=115)
    pp.create_line(net, from_bus=b114, to_bus=b115, length_km=0.081, std_type="3x240_Al_kbl_plus_120_Al_kbl",
                   name='114_115')
    pp.create_load(net, bus=b115, name=1047118694, p_mw=0.001)
    pp.create_load(net, bus=b115, name=1047118696, p_mw=0.001)
    pp.create_load(net, bus=b115, name=1047118732, p_mw=0.001)
    pp.create_load(net, bus=b115, name=1047118735, p_mw=0.001)
    # elagazas kozelebbre, az áldozat utcába lefele
    b116 = pp.create_bus(net, vn_kv=0.4, name=116)
    pp.create_line(net, from_bus=b115, to_bus=b116, length_km=0.0462, std_type="4x50_Al_kbl", name='115_116')
    pp.create_load(net, bus=b116, name=1047118697, p_mw=0.001)
    pp.create_load(net, bus=b116, name=1047118709, p_mw=0.001)
    b117 = pp.create_bus(net, vn_kv=0.4, name=117)
    pp.create_line(net, from_bus=b116, to_bus=b117, length_km=0.03207, std_type="4x50_Al_kbl", name='116_117')
    pp.create_load(net, bus=b117, name=1047118699, p_mw=0.001)
    pp.create_load(net, bus=b117, name=1047118701, p_mw=0.001)
    pp.create_load(net, bus=b117, name=1047118705, p_mw=0.001)
    pp.create_load(net, bus=b117, name=1047118703, p_mw=0.001)
    pp.create_load(net, bus=b117, name=1047118704, p_mw=0.001)
    pp.create_load(net, bus=b117, name=1047118698, p_mw=0.001)
    pp.create_load(net, bus=b117, name=1047118700, p_mw=0.001)
    b118 = pp.create_bus(net, vn_kv=0.4, name=118)
    pp.create_line(net, from_bus=b117, to_bus=b118, length_km=0.02696, std_type="4x50_Al_kbl", name='117_118')
    pp.create_load(net, bus=b118, name=1047106600, p_mw=0.001)
    pp.create_load(net, bus=b118, name=1047118708, p_mw=0.001)
    # elagazas jobbra
    b119 = pp.create_bus(net, vn_kv=0.4, name=119)
    pp.create_line(net, from_bus=b118, to_bus=b119, length_km=0.00925, std_type="4x50_Al_kbl", name='118_119')
    pp.create_load(net, bus=b119, name=1047106603, p_mw=0.001)
    # HIANYZIK AZ SAP 2-bol a fenti 1047106603
    pp.create_load(net, bus=b119, name=1047106605, p_mw=0.001)
    pp.create_load(net, bus=b119, name=1047106602, p_mw=0.001)
    pp.create_load(net, bus=b119, name=1047106604, p_mw=0.001)
    # es lefele
    b120 = pp.create_bus(net, vn_kv=0.4, name=120)
    pp.create_line(net, from_bus=b118, to_bus=b120, length_km=0.03050, std_type="4x50_Al_kbl", name='118_120')
    pp.create_load(net, bus=b120, name=1047106599, p_mw=0.001)
    pp.create_load(net, bus=b120, name=1047106601, p_mw=0.001)
    # hianyzik 10665/2-rol 2 es 10626/1-rol 1
    # elagazas kozelebbre, az áldozat utcába felfele b115-rol
    b121 = pp.create_bus(net, vn_kv=0.4, name=121)
    pp.create_line(net, from_bus=b115, to_bus=b121, length_km=0.0991, std_type="4x185_Al_kbl", name='115_121')
    pp.create_load(net, bus=b121, name=1047118711, p_mw=0.001)
    pp.create_load(net, bus=b121, name=1047118710, p_mw=0.001)
    pp.create_load(net, bus=b121, name=1047106549, p_mw=0.001)
    b122 = pp.create_bus(net, vn_kv=0.4, name=122)
    pp.create_line(net, from_bus=b121, to_bus=b122, length_km=0.087, std_type="4x185_Al_kbl", name='121_122')
    pp.create_load(net, bus=b122, name=1047118722, p_mw=0.001)
    # HIANYZIK AZ SAP2-bol a fenti 1047118722
    pp.create_load(net, bus=b122, name=1047106520, p_mw=0.001)
    pp.create_load(net, bus=b122, name=1079861548, p_mw=0.001)
    pp.create_load(net, bus=b122, name=1047106519, p_mw=0.001)
    pp.create_load(net, bus=b122, name=1047118712, p_mw=0.001)
    pp.create_load(net, bus=b122, name=1047106517, p_mw=0.001)
    pp.create_load(net, bus=b122, name=1047106516, p_mw=0.001)
    pp.create_load(net, bus=b122, name=1047118716, p_mw=0.001)
    pp.create_load(net, bus=b122, name=1047118717, p_mw=0.001)
    b123 = pp.create_bus(net, vn_kv=0.4, name=123)
    pp.create_line(net, from_bus=b122, to_bus=b123, length_km=0.03599, std_type="4x95 Ml", name='122_123')
    pp.create_load(net, bus=b123, name=1047118714, p_mw=0.001)
    pp.create_load(net, bus=b123, name=1047118720, p_mw=0.001)
    pp.create_load(net, bus=b123, name=1049678681, p_mw=0.001)
    pp.create_load(net, bus=b123, name=1047118719, p_mw=0.001)
    pp.create_load(net, bus=b123, name=1047118713, p_mw=0.001)
    b124 = pp.create_bus(net, vn_kv=0.4, name=124)
    pp.create_line(net, from_bus=b123, to_bus=b124, length_km=0.04257, std_type="4x95 Ml", name='123_124')
    pp.create_load(net, bus=b124, name=1047095994, p_mw=0.001)
    pp.create_load(net, bus=b124, name=1047118723, p_mw=0.001)
    pp.create_load(net, bus=b124, name=1047111766, p_mw=0.001)
    pp.create_load(net, bus=b124, name=1047118726, p_mw=0.001)
    pp.create_load(net, bus=b124, name=1047118728, p_mw=0.001)
    # tovabb a horgony utcan
    b125 = pp.create_bus(net, vn_kv=0.4, name=125)
    pp.create_line(net, from_bus=b124, to_bus=b125, length_km=0.0323, std_type="4x95 Ml", name='124_125')
    pp.create_load(net, bus=b125, name=1047118725, p_mw=0.001)
    pp.create_load(net, bus=b125, name=1047118729, p_mw=0.001)
    pp.create_load(net, bus=b125, name=1079928408, p_mw=0.001)
    pp.create_load(net, bus=b125, name=1080345939, p_mw=0.001)
    pp.create_load(net, bus=b125, name=1049675101, p_mw=0.001)
    b126 = pp.create_bus(net, vn_kv=0.4, name=126)
    pp.create_line(net, from_bus=b125, to_bus=b126, length_km=0.03702, std_type="4x95 Ml", name='125_126')
    pp.create_load(net, bus=b126, name=1049675053, p_mw=0.001)
    pp.create_load(net, bus=b126, name=1047106598, p_mw=0.001)
    pp.create_load(net, bus=b126, name=1049675960, p_mw=0.001)
    pp.create_load(net, bus=b126, name=1049679899, p_mw=0.001)
    pp.create_load(net, bus=b126, name=1047111763, p_mw=0.001)
    # tovabb a b124-rol a zolyom utcan balra
    b126 = pp.create_bus(net, vn_kv=0.4, name=126)
    pp.create_line(net, from_bus=b124, to_bus=b126, length_km=0.03499, std_type="4x35_ML", name='124_126')
    # hianyzik 10705/4
    b127 = pp.create_bus(net, vn_kv=0.4, name=127)
    pp.create_line(net, from_bus=b126, to_bus=b127, length_km=0.03478, std_type="4x35_ML", name='126_127')
    pp.create_load(net, bus=b127, name=1047118730, p_mw=0.001)
    pp.create_load(net, bus=b127, name=1047118724, p_mw=0.001)
    b128 = pp.create_bus(net, vn_kv=0.4, name=128)
    pp.create_line(net, from_bus=b127, to_bus=b128, length_km=0.02867, std_type="4x35_ML", name='127_128')
    # balra le
    b129 = pp.create_bus(net, vn_kv=0.4, name=129)
    pp.create_line(net, from_bus=b128, to_bus=b129, length_km=0.02375, std_type="4x35_ML", name='128_129')
    pp.create_load(net, bus=b129, name=1047118731, p_mw=0.001)
    b130 = pp.create_bus(net, vn_kv=0.4, name=130)
    pp.create_line(net, from_bus=b129, to_bus=b130, length_km=0.02115, std_type="4x35_ML", name='129_130')
    pp.create_load(net, bus=b130, name=1047106525, p_mw=0.001)
    pp.create_load(net, bus=b130, name=1047106526, p_mw=0.001)
    # jobbra fel b128-rol
    b131 = pp.create_bus(net, vn_kv=0.4, name=131)
    pp.create_line(net, from_bus=b128, to_bus=b131, length_km=0.03516, std_type="4x35_ML", name='128_131')
    # leagazas harom fogyasztohoz
    b132 = pp.create_bus(net, vn_kv=0.4, name=132)
    pp.create_line(net, from_bus=b131, to_bus=b132, length_km=0.04397, std_type="3x16_Al", name='131_132')
    pp.create_load(net, bus=b132, name=1080345493, p_mw=0.001)
    # ketto hianyzik hrsz 10699, 10702
    # tovabb b131-rol fel
    b132 = pp.create_bus(net, vn_kv=0.4, name=132)
    pp.create_line(net, from_bus=b131, to_bus=b132, length_km=0.0354, std_type="4x35_ML", name='131_132')
    pp.create_load(net, bus=b132, name=1047106554, p_mw=0.001)
    pp.create_load(net, bus=b132, name=1047106557, p_mw=0.001)
    b133 = pp.create_bus(net, vn_kv=0.4, name=133)
    pp.create_line(net, from_bus=b132, to_bus=b133, length_km=0.10713, std_type="4x35_ML", name='132_133')
    pp.create_load(net, bus=b133, name=1047106559, p_mw=0.001)
    pp.create_load(net, bus=b133, name=1047106560, p_mw=0.001)
    pp.create_load(net, bus=b133, name=1047106541, p_mw=0.001)
    b134 = pp.create_bus(net, vn_kv=0.4, name=134)
    pp.create_line(net, from_bus=b133, to_bus=b134, length_km=0.1049, std_type="4x35_ML", name='133_134')
    pp.create_load(net, bus=b134, name=1047118626, p_mw=0.001)
    b135 = pp.create_bus(net, vn_kv=0.4, name=135)
    pp.create_line(net, from_bus=b134, to_bus=b135, length_km=0.03793, std_type="4x35_ML", name='134_135')
    pp.create_load(net, bus=b135, name=1047106561, p_mw=0.001)
    pp.create_load(net, bus=b135, name=1047106562, p_mw=0.001)
    # b115-rol leagazas a legnyugatibb pont fele
    b136 = pp.create_bus(net, vn_kv=0.4, name=136)
    pp.create_line(net, from_bus=b115, to_bus=b136, length_km=0.0604, std_type="4x120_Al_kbl", name='115_136')
    pp.create_load(net, bus=b136, name=1047118734, p_mw=0.001)
    pp.create_load(net, bus=b136, name=1047118733, p_mw=0.001)
    # hianyzo fogyaszto a 10652 hrsz-rol
    b137 = pp.create_bus(net, vn_kv=0.4, name=137)
    pp.create_line(net, from_bus=b136, to_bus=b137, length_km=0.0273, std_type="4x120_Al_kbl", name='136_137')
    pp.create_load(net, bus=b137, name=1047118743, p_mw=0.001)
    pp.create_load(net, bus=b137, name=1047118740, p_mw=0.001)
    pp.create_load(net, bus=b137, name=1047118738, p_mw=0.001)
    pp.create_load(net, bus=b137, name=1047118736, p_mw=0.001)
    b138 = pp.create_bus(net, vn_kv=0.4, name=138)
    pp.create_line(net, from_bus=b137, to_bus=b138, length_km=0.0311, std_type="4x50_ML", name='137_138')
    pp.create_load(net, bus=b138, name=1047106530, p_mw=0.001)
    pp.create_load(net, bus=b138, name=1047118741, p_mw=0.001)
    pp.create_load(net, bus=b138, name=1047118737, p_mw=0.001)
    # leagazas
    b139 = pp.create_bus(net, vn_kv=0.4, name=139)
    pp.create_line(net, from_bus=b138, to_bus=b139, length_km=0.0417, std_type="4x50_ML", name='138_139')
    b140 = pp.create_bus(net, vn_kv=0.4, name=140)
    pp.create_line(net, from_bus=b139, to_bus=b140, length_km=0.0380, std_type="4x25_ML", name='139_140')
    pp.create_load(net, bus=b140, name=1047118695, p_mw=0.001)
    # leagazas
    b141 = pp.create_bus(net, vn_kv=0.4, name=141)
    pp.create_line(net, from_bus=b138, to_bus=b141, length_km=0.0786, std_type="4x50_ML", name='138_141')
    pp.create_load(net, bus=b141, name=1047106521, p_mw=0.001)
    pp.create_load(net, bus=b141, name=1047106527, p_mw=0.001)
    # hianyzo fogyaszto a 543244, 262383 EOV koordinatan - szabadstrand
    # hianyzo fogyaszto a 543203, 262280 EOV koordinatan - szabadstrand
    # szabadstrandon fid: 1080009201 random helyre van bekotve
    # b115-rol leagazas a mezo utcara
    b142 = pp.create_bus(net, vn_kv=0.4, name=142)
    pp.create_line(net, from_bus=b115, to_bus=b142, length_km=0.1235, std_type="4x150_Al_kbl", name='115_142')
    pp.create_load(net, bus=b142, name=1047106547, p_mw=0.001)
    pp.create_load(net, bus=b142, name=1047118681, p_mw=0.001)
    pp.create_load(net, bus=b142, name=1047118692, p_mw=0.001)
    pp.create_load(net, bus=b142, name=1047106548, p_mw=0.001)
    pp.create_load(net, bus=b142, name=1047118693, p_mw=0.001)
    b143 = pp.create_bus(net, vn_kv=0.4, name=143)
    pp.create_line(net, from_bus=b142, to_bus=b143, length_km=0.0360, std_type="4x50_ML", name='142_143')
    pp.create_load(net, bus=b143, name=1047118682, p_mw=0.001)
    pp.create_load(net, bus=b143, name=1047118684, p_mw=0.001)
    pp.create_load(net, bus=b143, name=1047118679, p_mw=0.001)
    b144 = pp.create_bus(net, vn_kv=0.4, name=144)
    pp.create_line(net, from_bus=b143, to_bus=b144, length_km=0.0291, std_type="4x50_ML", name='143_144')
    pp.create_load(net, bus=b144, name=1047118691, p_mw=0.001)
    pp.create_load(net, bus=b144, name=1047118680, p_mw=0.001)
    pp.create_load(net, bus=b144, name=1047118689, p_mw=0.001)
    b145 = pp.create_bus(net, vn_kv=0.4, name=145)
    pp.create_line(net, from_bus=b144, to_bus=b145, length_km=0.0299, std_type="4x50_ML", name='144_145')
    pp.create_load(net, bus=b145, name=1047118690, p_mw=0.001)
    pp.create_load(net, bus=b145, name=1047118683, p_mw=0.001)
    pp.create_load(net, bus=b145, name=1049673994, p_mw=0.001)
    pp.create_load(net, bus=b145, name=1047118687, p_mw=0.001)
    b146 = pp.create_bus(net, vn_kv=0.4, name=146)
    pp.create_line(net, from_bus=b145, to_bus=b146, length_km=0.0209, std_type="4x50_ML", name='145_146')
    pp.create_load(net, bus=b146, name=1047118727, p_mw=0.001)
    # B10
    b147 = pp.create_bus(net, vn_kv=0.4, name=147)
    pp.create_switch(net, bus=trafo_lv_side, element=b110, et='b', type='CB', name='B10')
    b148 = pp.create_bus(net, vn_kv=0.4, name=148)
    pp.create_line(net, from_bus=b147, to_bus=b148, length_km=0.3501, std_type="3x240_Al_kbl_plus_120_Al_kbl",
                   name='147_148')
    pp.create_load(net, bus=b148, name=2111641746, p_mw=0.001)

    corr_exact(net)
    # print network and run power flow
    pp.add_zero_impedance_parameters(net)
    '''#in case of run:
    print(net.line)
    print(net.bus)
    print(net.trafo)
    pp.runpp(net, calculate_voltage_angles=True, init='auto', max_iteration='auto',
             tolerance_mva=1e-08, enforce_q_lims=False, numba=True, recycle=None,
             check_connectivity=True, switch_rx_ratio=2.0, delta_q=0, v_debug=False)
    print(net.res_bus.vm_pu)
    print(net.res_line.loading_percent)'''
    return net


if __name__ == "__main__":
    net = create()
