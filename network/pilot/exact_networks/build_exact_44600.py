# -*- coding: utf-8 -*-
"""
Created on Fri Jul 16 09:47:53 2021

@author: Gergő
"""

import pandapower as pp


def create(path='.'):
    # empty net
    net = pp.create_empty_network()
    trafo_data = {'vn_hv_kv': 22, 'vn_lv_kv': 0.42,
                  'vk_percent': 3.747, 'vkr_percent': 1.4,
                  'vk0_percent': 3.747, 'vkr0_percent': 1.4,
                  'sn_mva': 0.4, 'i0_percent': 2.5,
                  'vector_group': 'Dyn5', "shift_degree": 150,
                  'pfe_kw': 0.57}
    # create type for the trafo
    pp.create_std_type(net, trafo_data, name='4HB5667-4ZA', element='trafo')
    trafo_mv_side = pp.create_bus(net, vn_kv=22, name="Trafo MV")
    trafo_lv_side = pp.create_bus(net, vn_kv=0.42, name="Trafo LV")
    # Create bus for external grid
    bus0 = pp.create_bus(net, vn_kv=22, name="Ext grid")
    pp.create_transformer(net, hv_bus=trafo_mv_side, lv_bus=trafo_lv_side, std_type='4HB5667-4ZA')
    # Create external grid and switch
    pp.create_ext_grid(net, bus=bus0)
    pp.create_switch(net, bus=bus0, element=trafo_mv_side, et='b', closed=True, type='CB', name='S1')
    _4x95Al = {"r_ohm_per_km": 0.311, "x_ohm_per_km": 0.34, "c_nf_per_km": 0, "max_i_ka": 0.25,
               "r0_ohm_per_km": 1.244, "x0_ohm_per_km": 1.36, "c0_nf_per_km": 0}
    pp.create_std_type(net, _4x95Al, name="4x95 Al", element="line")
    _4x95Ml = {"r_ohm_per_km": 0.311, "x_ohm_per_km": 0.071, "c_nf_per_km": 0, "max_i_ka": 0.16,
               "r0_ohm_per_km": 1.244, "x0_ohm_per_km": 0.284, "c0_nf_per_km": 0}
    pp.create_std_type(net, _4x95Ml, name="4x95 Ml", element="line")
    _4x50Al = {"r_ohm_per_km": 0.603, "x_ohm_per_km": 0.357, "c_nf_per_km": 0, "max_i_ka": 0.16,
               "r0_ohm_per_km": 2.412, "x0_ohm_per_km": 1.428, "c0_nf_per_km": 0}
    pp.create_std_type(net, _4x50Al, name="4x50 Al", element="line")
    _10_Al_plus_25_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.4, "c_nf_per_km": 0, "max_i_ka": 50}
    pp.create_std_type(net, _10_Al_plus_25_Al, name="10_Al_plus_25_Al", element="line")
    _3x10_Al_plus_25_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.4, "c_nf_per_km": 0, "max_i_ka": 50}
    pp.create_std_type(net, _3x10_Al_plus_25_Al, name="3x10_Al_plus_25_Al", element="line")
    _3x10_ML_plus_25_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.091, "c_nf_per_km": 0, "max_i_ka": 32}
    pp.create_std_type(net, _3x10_ML_plus_25_Al, name="3x10_ML_plus_25_Al", element="line")
    _3x16_Al = {"r_ohm_per_km": 1.83, "x_ohm_per_km": 0.39, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _3x16_Al, name="3x16_Al", element="line")
    _3x16_Al_plus_25_Al = {"r_ohm_per_km": 1.83, "x_ohm_per_km": 0.39, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _3x16_Al_plus_25_Al, name="3x16_Al_plus_25_Al", element="line")
    _3x240_Al_kbl_plus_120_Al_kbl = {"r_ohm_per_km": 0.125, "x_ohm_per_km": 0.088, "c_nf_per_km": 0, "max_i_ka": 250}
    pp.create_std_type(net, _3x240_Al_kbl_plus_120_Al_kbl, name="3x240_Al_kbl_plus_120_Al_kbl", element="line")
    _3x70_Al_plus_50_Al = {"r_ohm_per_km": 0.447, "x_ohm_per_km": 0.35, "c_nf_per_km": 0, "max_i_ka": 200}
    pp.create_std_type(net, _3x70_Al_plus_50_Al, name="3x70_Al_plus_50_Al", element="line")
    _4x10_Al = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.4, "c_nf_per_km": 0, "max_i_ka": 50}
    pp.create_std_type(net, _4x10_Al, name="4x10_Al", element="line")
    _4x10_ML = {"r_ohm_per_km": 3.08, "x_ohm_per_km": 0.091, "c_nf_per_km": 0, "max_i_ka": 32}
    pp.create_std_type(net, _4x10_ML, name="4x10_ML", element="line")
    _4x120_Al_kbl = {"r_ohm_per_km": 0.253, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 160}
    pp.create_std_type(net, _4x120_Al_kbl, name="4x120_Al_kbl", element="line")
    _4x150_Al_kbl = {"r_ohm_per_km": 0.206, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 200}
    pp.create_std_type(net, _4x150_Al_kbl, name="4x150_Al_kbl", element="line")
    _4x185_Al_kbl = {"r_ohm_per_km": 0.164, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 250}
    pp.create_std_type(net, _4x185_Al_kbl, name="4x185_Al_kbl", element="line")
    _4x240_Al_kbl = {"r_ohm_per_km": 0.125, "x_ohm_per_km": 0.088, "c_nf_per_km": 0, "max_i_ka": 250}
    pp.create_std_type(net, _4x240_Al_kbl, name="4x240_Al_kbl", element="line")
    _4x25_Al = {"r_ohm_per_km": 1.2, "x_ohm_per_km": 0.38, "c_nf_per_km": 0, "max_i_ka": 100}
    pp.create_std_type(net, _4x25_Al, name="4x25_Al", element="line")
    _4x25_ML = {"r_ohm_per_km": 1.2, "x_ohm_per_km": 0.078, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _4x25_ML, name="4x25_ML", element="line")
    _4x35_ML = {"r_ohm_per_km": 0.867, "x_ohm_per_km": 0.078, "c_nf_per_km": 0, "max_i_ka": 63}
    pp.create_std_type(net, _4x35_ML, name="4x35_ML", element="line")
    _4x50_Al_kbl = {"r_ohm_per_km": 0.641, "x_ohm_per_km": 0.093, "c_nf_per_km": 0, "max_i_ka": 100}
    pp.create_std_type(net, _4x50_Al_kbl, name="4x50_Al_kbl", element="line")
    _4x50_ML = {"r_ohm_per_km": 0.617, "x_ohm_per_km": 0.073, "c_nf_per_km": 0, "max_i_ka": 100}
    pp.create_std_type(net, _4x50_ML, name="4x50_ML", element="line")
    _4x95_Al_kbl = {"r_ohm_per_km": 0.32, "x_ohm_per_km": 0.09, "c_nf_per_km": 0, "max_i_ka": 125}
    pp.create_std_type(net, _4x95_Al_kbl, name="4x95_Al_kbl", element="line")
    # B1
    b0 = pp.create_bus(net, vn_kv=0.4, name=0)
    pp.create_switch(net, bus=trafo_lv_side, element=b0, et='b', type='CB', name='B1')
    pp.create_load(net, bus=b0, name=2120910457, p_mw=0.001)
    b1 = pp.create_bus(net, vn_kv=0.4, name=1)
    pp.create_line(net, from_bus=b0, to_bus=b1, length_km=0.0218, std_type="4x95 Ml", name='0_1')
    pp.create_load(net, bus=b1, name=2120908664, p_mw=0.001)
    b2 = pp.create_bus(net, vn_kv=0.4, name=2)
    pp.create_line(net, from_bus=b1, to_bus=b2, length_km=0.0399, std_type="4x95 Ml", name='1_2')
    pp.create_load(net, bus=b2, name=2120909008, p_mw=0.001)
    pp.create_load(net, bus=b2, name=2120911179, p_mw=0.001)
    pp.create_load(net, bus=b2, name=2120908581, p_mw=0.001)
    # egy hianyzik 707 helyrajzi szam
    b3 = pp.create_bus(net, vn_kv=0.4, name=3)
    pp.create_line(net, from_bus=b2, to_bus=b3, length_km=0.0227, std_type="4x50 Al", name='2_3')
    b4 = pp.create_bus(net, vn_kv=0.4, name=4)
    pp.create_line(net, from_bus=b3, to_bus=b4, length_km=0.0192, std_type="4x50 Al", name='3_4')
    pp.create_load(net, bus=b4, name=2120910160, p_mw=0.001)
    pp.create_load(net, bus=b4, name=2120910790, p_mw=0.001)
    pp.create_load(net, bus=b4, name=2120908859, p_mw=0.001)
    b5 = pp.create_bus(net, vn_kv=0.4, name=5)
    pp.create_line(net, from_bus=b4, to_bus=b5, length_km=0.0152, std_type="4x50 Al", name='4_5')
    pp.create_load(net, bus=b5, name=2120910888, p_mw=0.001)
    b6 = pp.create_bus(net, vn_kv=0.4, name=6)
    pp.create_line(net, from_bus=b5, to_bus=b6, length_km=0.0371, std_type="4x50 Al", name='5_6')
    pp.create_load(net, bus=b6, name=2120909227, p_mw=0.001)
    pp.create_load(net, bus=b6, name=2120910147, p_mw=0.001)
    pp.create_load(net, bus=b6, name=2120909987, p_mw=0.001)
    b7 = pp.create_bus(net, vn_kv=0.4, name=7)
    pp.create_line(net, from_bus=b6, to_bus=b7, length_km=0.0286, std_type="4x50 Al", name='6_7')
    b8 = pp.create_bus(net, vn_kv=0.4, name=8)
    pp.create_line(net, from_bus=b7, to_bus=b8, length_km=0.0378, std_type="4x50 Al", name='7_8')
    b9 = pp.create_bus(net, vn_kv=0.4, name=9)
    pp.create_line(net, from_bus=b8, to_bus=b9, length_km=0.0358, std_type="4x50 Al", name='8_9')
    pp.create_load(net, bus=b9, name=2120909108, p_mw=0.001)
    b10 = pp.create_bus(net, vn_kv=0.4, name=10)
    pp.create_line(net, from_bus=b9, to_bus=b10, length_km=0.0498, std_type="4x50 Al", name='9_10')
    pp.create_load(net, bus=b10, name=2120909537, p_mw=0.001)
    pp.create_load(net, bus=b10, name=2120909547, p_mw=0.001)
    pp.create_load(net, bus=b10, name=2120910150, p_mw=0.001)
    pp.create_load(net, bus=b10, name=2120910454, p_mw=0.001)
    b11 = pp.create_bus(net, vn_kv=0.4, name=11)
    pp.create_line(net, from_bus=b10, to_bus=b11, length_km=0.0546, std_type="4x50 Al", name='10_11')
    pp.create_load(net, bus=b11, name=2120908552, p_mw=0.001)
    pp.create_load(net, bus=b11, name=2120910316, p_mw=0.001)
    pp.create_load(net, bus=b11, name=2120911360, p_mw=0.001)
    b12 = pp.create_bus(net, vn_kv=0.4, name=12)
    pp.create_line(net, from_bus=b11, to_bus=b12, length_km=0.0543, std_type="4x50 Al", name='11_12')
    pp.create_load(net, bus=b12, name=2120909328, p_mw=0.001)
    pp.create_load(net, bus=b12, name=2120910952, p_mw=0.001)
    pp.create_load(net, bus=b12, name=2120910402, p_mw=0.001)
    pp.create_load(net, bus=b12, name=2120909311, p_mw=0.001)
    b13 = pp.create_bus(net, vn_kv=0.4, name=13)
    pp.create_line(net, from_bus=b12, to_bus=b13, length_km=0.0473, std_type="4x50 Al", name='12_13')
    pp.create_load(net, bus=b13, name=2120910990, p_mw=0.001)
    pp.create_load(net, bus=b13, name=2120909468, p_mw=0.001)
    pp.create_load(net, bus=b13, name=2120909212, p_mw=0.001)
    pp.create_load(net, bus=b13, name=2120908958, p_mw=0.001)
    b14 = pp.create_bus(net, vn_kv=0.4, name=14)
    pp.create_line(net, from_bus=b13, to_bus=b14, length_km=0.0490, std_type="4x50 Al", name='13_14')
    pp.create_load(net, bus=b13, name=2120909119, p_mw=0.001)
    pp.create_load(net, bus=b13, name=2120910295, p_mw=0.001)
    # at a cserfa utacara b11-rol 748 es 747 helyrajzi szamok kozott
    b14 = pp.create_bus(net, vn_kv=0.4, name=14)
    pp.create_line(net, from_bus=b11, to_bus=b14, length_km=0.039, std_type="4x25_Al", name='11_14')
    pp.create_load(net, bus=b14, name=2120911288, p_mw=0.001)
    pp.create_load(net, bus=b14, name=2120911393, p_mw=0.001)
    # b8-rol 743 es 712 kozott be a sport utcaba
    b15 = pp.create_bus(net, vn_kv=0.4, name=15)
    pp.create_line(net, from_bus=b8, to_bus=b15, length_km=0.0417, std_type="4x50 Al", name='8_15')
    pp.create_load(net, bus=b15, name=2120909614, p_mw=0.001)
    pp.create_load(net, bus=b15, name=2120908645, p_mw=0.001)
    pp.create_load(net, bus=b15, name=2120910696, p_mw=0.001)
    pp.create_load(net, bus=b15, name=2120911087, p_mw=0.001)
    pp.create_load(net, bus=b15, name=2120909413, p_mw=0.001)
    pp.create_load(net, bus=b15, name=2120909691, p_mw=0.001)
    pp.create_load(net, bus=b15, name=2120909712, p_mw=0.001)
    pp.create_load(net, bus=b15, name=2120909785, p_mw=0.001)
    # b6-rol el jobbra, be a sport utcaba
    b16 = pp.create_bus(net, vn_kv=0.4, name=16)
    pp.create_line(net, from_bus=b6, to_bus=b16, length_km=0.0373, std_type="4x25_Al", name='6_16')
    pp.create_load(net, bus=b16, name=1081588936, p_mw=0.001)
    pp.create_load(net, bus=b16, name=2120910129, p_mw=0.001)
    b17 = pp.create_bus(net, vn_kv=0.4, name=17)
    pp.create_line(net, from_bus=b16, to_bus=b17, length_km=0.0401, std_type="4x25_Al", name='16_17')
    pp.create_load(net, bus=b17, name=2120910552, p_mw=0.001)
    pp.create_load(net, bus=b17, name=2120908627, p_mw=0.001)
    b18 = pp.create_bus(net, vn_kv=0.4, name=18)
    pp.create_line(net, from_bus=b17, to_bus=b18, length_km=0.0145, std_type="4x25_Al", name='17_18')
    pp.create_load(net, bus=b18, name=2120908862, p_mw=0.001)
    pp.create_load(net, bus=b18, name=2120909129, p_mw=0.001)
    pp.create_load(net, bus=b18, name=2120908722, p_mw=0.001)
    # b4-rol a tuzolto utcarol be a kiskoz utcaba jobbra
    b19 = pp.create_bus(net, vn_kv=0.4, name=19)
    pp.create_line(net, from_bus=b4, to_bus=b19, length_km=0.0382, std_type="4x50 Al", name='4_19')
    pp.create_load(net, bus=b19, name=2120909687, p_mw=0.001)
    pp.create_load(net, bus=b19, name=2120909861, p_mw=0.001)
    pp.create_load(net, bus=b19, name=2120908815, p_mw=0.001)
    pp.create_load(net, bus=b19, name=2120909405, p_mw=0.001)
    pp.create_load(net, bus=b19, name=2120908685, p_mw=0.001)
    pp.create_load(net, bus=b19, name=2120910572, p_mw=0.001)
    # b4-rol a tuzolto utcarol be a kiskoz utcaba balra
    b20 = pp.create_bus(net, vn_kv=0.4, name=20)
    pp.create_line(net, from_bus=b4, to_bus=b20, length_km=0.0374, std_type="4x50 Al", name='4_20')
    pp.create_load(net, bus=b20, name=2120910273, p_mw=0.001)
    b21 = pp.create_bus(net, vn_kv=0.4, name=21)
    pp.create_line(net, from_bus=b20, to_bus=b21, length_km=0.0353, std_type="4x50 Al", name='20_21')
    pp.create_load(net, bus=b21, name=2120909583, p_mw=0.001)
    pp.create_load(net, bus=b21, name=2120910362, p_mw=0.001)
    pp.create_load(net, bus=b21, name=2120909032, p_mw=0.001)
    b22 = pp.create_bus(net, vn_kv=0.4, name=22)
    pp.create_line(net, from_bus=b21, to_bus=b22, length_km=0.0392, std_type="4x50 Al", name='21_22')
    pp.create_load(net, bus=b22, name=2120910143, p_mw=0.001)
    pp.create_load(net, bus=b22, name=2120909605, p_mw=0.001)
    # b2-rol be balra
    b23 = pp.create_bus(net, vn_kv=0.4, name=23)
    pp.create_line(net, from_bus=b2, to_bus=b23, length_km=0.0245, std_type="3x70_Al_plus_50_Al", name='2_23')
    pp.create_load(net, bus=b23, name=2120910146, p_mw=0.001)
    pp.create_load(net, bus=b23, name=2120910514, p_mw=0.001)
    pp.create_load(net, bus=b23, name=2120908666, p_mw=0.001)
    b24 = pp.create_bus(net, vn_kv=0.4, name=24)
    pp.create_line(net, from_bus=b23, to_bus=b24, length_km=0.0308, std_type="3x70_Al_plus_50_Al", name='23_24')
    b25 = pp.create_bus(net, vn_kv=0.4, name=25)
    pp.create_line(net, from_bus=b24, to_bus=b25, length_km=0.0360, std_type="3x70_Al_plus_50_Al", name='24_25')
    pp.create_load(net, bus=b25, name=2120909784, p_mw=0.001)
    # egy hianyzik 704 helyrajzi
    b26 = pp.create_bus(net, vn_kv=0.4, name=26)
    pp.create_line(net, from_bus=b25, to_bus=b26, length_km=0.0255, std_type="3x70_Al_plus_50_Al", name='25_26')
    # egy hianyzik 703 helyrajzi
    # B5
    b27 = pp.create_bus(net, vn_kv=0.4, name=27)
    pp.create_switch(net, bus=trafo_lv_side, element=b27, et='b', type='CB', name='B5')
    b28 = pp.create_bus(net, vn_kv=0.4, name=28)
    pp.create_line(net, from_bus=b27, to_bus=b28, length_km=0.0306, std_type="4x95 Ml", name='27_28')
    pp.create_load(net, bus=b28, name=2120910235, p_mw=0.001)
    pp.create_load(net, bus=b28, name=2120910796, p_mw=0.001)
    b29 = pp.create_bus(net, vn_kv=0.4, name=29)
    pp.create_line(net, from_bus=b28, to_bus=b29, length_km=0.0351, std_type="4x95 Ml", name='28_29')
    pp.create_load(net, bus=29, name=2120910202, p_mw=0.001)
    pp.create_load(net, bus=29, name=2120909035, p_mw=0.001)
    b30 = pp.create_bus(net, vn_kv=0.4, name=30)
    pp.create_line(net, from_bus=b29, to_bus=b30, length_km=0.0311, std_type="4x95 Ml", name='29_30')
    b31 = pp.create_bus(net, vn_kv=0.4, name=31)
    pp.create_line(net, from_bus=b30, to_bus=b31, length_km=0.0260, std_type="4x50 Al", name='30_31')
    pp.create_load(net, bus=31, name=2120909682, p_mw=0.001)
    pp.create_load(net, bus=31, name=2120910618, p_mw=0.001)
    pp.create_load(net, bus=31, name=2120910180, p_mw=0.001)
    pp.create_load(net, bus=31, name=2124380743, p_mw=0.001)
    pp.create_load(net, bus=31, name=2120909870, p_mw=0.001)
    pp.create_load(net, bus=31, name=2120911222, p_mw=0.001)
    pp.create_load(net, bus=31, name=2120911228, p_mw=0.001)
    b32 = pp.create_bus(net, vn_kv=0.4, name=32)
    pp.create_line(net, from_bus=b31, to_bus=b32, length_km=0.0251, std_type="4x50 Al", name='31_32')
    pp.create_load(net, bus=32, name=2120910876, p_mw=0.001)
    b33 = pp.create_bus(net, vn_kv=0.4, name=33)
    pp.create_line(net, from_bus=b32, to_bus=b33, length_km=0.0265, std_type="4x50 Al", name='32_33')
    pp.create_load(net, bus=33, name=2120909207, p_mw=0.001)
    pp.create_load(net, bus=33, name=2120911349, p_mw=0.001)
    pp.create_load(net, bus=33, name=2120909764, p_mw=0.001)
    pp.create_load(net, bus=33, name=2120911411, p_mw=0.001)
    pp.create_load(net, bus=33, name=2120908726, p_mw=0.001)
    pp.create_load(net, bus=33, name=2120909838, p_mw=0.001)
    pp.create_load(net, bus=33, name=2120910451, p_mw=0.001)
    b34 = pp.create_bus(net, vn_kv=0.4, name=34)
    pp.create_line(net, from_bus=b33, to_bus=b34, length_km=0.0329, std_type="4x50 Al", name='33_34')
    pp.create_load(net, bus=34, name=2120911418, p_mw=0.001)
    pp.create_load(net, bus=34, name=2120910271, p_mw=0.001)
    pp.create_load(net, bus=34, name=2120909250, p_mw=0.001)
    b35 = pp.create_bus(net, vn_kv=0.4, name=35)
    pp.create_line(net, from_bus=b34, to_bus=b35, length_km=0.0296, std_type="4x25_ML", name='34_35')
    pp.create_load(net, bus=35, name=2120909458, p_mw=0.001)

    # B4
    b36 = pp.create_bus(net, vn_kv=0.4, name=36)
    pp.create_switch(net, bus=trafo_lv_side, element=b36, et='b', type='CB', name='B4')
    b37 = pp.create_bus(net, vn_kv=0.4, name=37)
    pp.create_line(net, from_bus=b36, to_bus=b37, length_km=0.0306, std_type="4x95 Ml", name='36_37')
    pp.create_load(net, bus=b37, name=2120909485, p_mw=0.001)
    pp.create_load(net, bus=b37, name=1080012208, p_mw=0.001)
    b38 = pp.create_bus(net, vn_kv=0.4, name=38)
    pp.create_line(net, from_bus=b37, to_bus=b38, length_km=0.0351, std_type="3x70_Al_plus_50_Al", name='37_38')
    pp.create_load(net, bus=b38, name=2120909000, p_mw=0.001)
    pp.create_load(net, bus=b38, name=2120909826, p_mw=0.001)
    pp.create_load(net, bus=b38, name=2120909990, p_mw=0.001)
    b39 = pp.create_bus(net, vn_kv=0.4, name=39)
    pp.create_line(net, from_bus=b38, to_bus=b39, length_km=0.0311, std_type="3x70_Al_plus_50_Al", name='38_39')
    pp.create_load(net, bus=b39, name=2120910954, p_mw=0.001)
    pp.create_load(net, bus=b39, name=2120910361, p_mw=0.001)
    pp.create_load(net, bus=b39, name=2120909960, p_mw=0.001)
    pp.create_load(net, bus=b39, name=2120908928, p_mw=0.001)
    pp.create_load(net, bus=b39, name=2120908900, p_mw=0.001)
    # felfele
    b40 = pp.create_bus(net, vn_kv=0.4, name=40)
    pp.create_line(net, from_bus=b39, to_bus=b40, length_km=0.0475, std_type="4x25_Al", name='39_40')
    pp.create_load(net, bus=40, name=2120910948, p_mw=0.001)
    pp.create_load(net, bus=40, name=2120911428, p_mw=0.001)
    b41 = pp.create_bus(net, vn_kv=0.4, name=41)
    pp.create_line(net, from_bus=b40, to_bus=b41, length_km=0.0398, std_type="4x25_Al", name='40_41')
    pp.create_load(net, bus=41, name=2120910713, p_mw=0.001)
    pp.create_load(net, bus=41, name=2124379808, p_mw=0.001)
    pp.create_load(net, bus=41, name=2120909488, p_mw=0.001)
    pp.create_load(net, bus=41, name=2120909799, p_mw=0.001)
    pp.create_load(net, bus=41, name=2120911167, p_mw=0.001)
    pp.create_load(net, bus=41, name=2120909059, p_mw=0.001)
    pp.create_load(net, bus=41, name=2120910882, p_mw=0.001)
    # b39-rol lefele
    b42 = pp.create_bus(net, vn_kv=0.4, name=42)
    pp.create_line(net, from_bus=b39, to_bus=b42, length_km=0.0363, std_type="3x70_Al_plus_50_Al", name='39_42')
    pp.create_load(net, bus=42, name=2120911237, p_mw=0.001)
    # balra
    b43 = pp.create_bus(net, vn_kv=0.4, name=43)
    pp.create_line(net, from_bus=b42, to_bus=b43, length_km=0.0207, std_type="4x50_ML", name='42_43')
    pp.create_load(net, bus=43, name=2120909885, p_mw=0.001)
    # ketto hianyzik 641, 644, 640 kozul ketto
    b44 = pp.create_bus(net, vn_kv=0.4, name=44)
    pp.create_line(net, from_bus=b43, to_bus=b44, length_km=0.0320, std_type="4x50_ML", name='43_44')
    b45 = pp.create_bus(net, vn_kv=0.4, name=45)
    pp.create_line(net, from_bus=b44, to_bus=b45, length_km=0.0381, std_type="4x50_ML", name='44_45')
    pp.create_load(net, bus=45, name=1080111749, p_mw=0.001)
    # harom hianyzik 631, 634, 630
    # jobbra b42-rol
    b46 = pp.create_bus(net, vn_kv=0.4, name=46)
    pp.create_line(net, from_bus=b42, to_bus=b46, length_km=0.0277, std_type="4x50_ML", name='42_46')
    pp.create_load(net, bus=46, name=2120909320, p_mw=0.001)
    b47 = pp.create_bus(net, vn_kv=0.4, name=47)
    pp.create_line(net, from_bus=b46, to_bus=b47, length_km=0.0247, std_type="4x50_ML", name='46_47')
    # tovabb lefele b42-rol
    b48 = pp.create_bus(net, vn_kv=0.4, name=48)
    pp.create_line(net, from_bus=b42, to_bus=b48, length_km=0.0317, std_type="3x70_Al_plus_50_Al", name='42_48')
    pp.create_load(net, bus=48, name=2120911298, p_mw=0.001)
    pp.create_load(net, bus=48, name=2120908910, p_mw=0.001)
    pp.create_load(net, bus=48, name=2120909464, p_mw=0.001)
    pp.create_load(net, bus=48, name=2120910965, p_mw=0.001)
    pp.create_load(net, bus=48, name=2120909320, p_mw=0.001)
    b49 = pp.create_bus(net, vn_kv=0.4, name=49)
    pp.create_line(net, from_bus=b48, to_bus=b49, length_km=0.0375, std_type="3x70_Al_plus_50_Al", name='48_49')
    pp.create_load(net, bus=49, name=1080006983, p_mw=0.001)
    pp.create_load(net, bus=49, name=2120910823, p_mw=0.001)
    pp.create_load(net, bus=49, name=2120910014, p_mw=0.001)
    pp.create_load(net, bus=49, name=2120911147, p_mw=0.001)
    pp.create_load(net, bus=49, name=2120908728, p_mw=0.001)
    pp.create_load(net, bus=49, name=2120910964, p_mw=0.001)
    # B3
    b50 = pp.create_bus(net, vn_kv=0.4, name=50)
    pp.create_switch(net, bus=trafo_lv_side, element=b50, et='b', type='CB', name='B3')
    b51 = pp.create_bus(net, vn_kv=0.4, name=51)
    pp.create_line(net, from_bus=b50, to_bus=b51, length_km=0.0081, std_type="4x95 Ml", name='50_51')
    pp.create_load(net, bus=51, name=2120910831, p_mw=0.001)
    pp.create_load(net, bus=51, name=2120909268, p_mw=0.001)
    b52 = pp.create_bus(net, vn_kv=0.4, name=52)
    pp.create_line(net, from_bus=b51, to_bus=b52, length_km=0.0348, std_type="4x95 Ml", name='51_52')
    pp.create_load(net, bus=52, name=2120908750, p_mw=0.001)
    pp.create_load(net, bus=52, name=2120909275, p_mw=0.001)
    pp.create_load(net, bus=52, name=2120911254, p_mw=0.001)
    b53 = pp.create_bus(net, vn_kv=0.4, name=53)
    pp.create_line(net, from_bus=b52, to_bus=b53, length_km=0.0357, std_type="3x70_Al_plus_50_Al", name='52_53')
    b54 = pp.create_bus(net, vn_kv=0.4, name=54)
    pp.create_line(net, from_bus=b53, to_bus=b54, length_km=0.0279, std_type="3x70_Al_plus_50_Al", name='53_54')
    pp.create_load(net, bus=54, name=2120911482, p_mw=0.001)
    pp.create_load(net, bus=54, name=2120910304, p_mw=0.001)
    pp.create_load(net, bus=54, name=2120911104, p_mw=0.001)
    # el jobbra
    b55 = pp.create_bus(net, vn_kv=0.4, name=55)
    pp.create_line(net, from_bus=b54, to_bus=b55, length_km=0.050, std_type="4x25_Al", name='54_55')
    pp.create_load(net, bus=55, name=2120910223, p_mw=0.001)
    pp.create_load(net, bus=55, name=2120910443, p_mw=0.001)
    pp.create_load(net, bus=55, name=2120911470, p_mw=0.001)
    # le
    b56 = pp.create_bus(net, vn_kv=0.4, name=56)
    pp.create_line(net, from_bus=b55, to_bus=b56, length_km=0.0161, std_type="4x25_Al", name='55_56')
    pp.create_load(net, bus=56, name=2120911367, p_mw=0.001)
    # fel
    b57 = pp.create_bus(net, vn_kv=0.4, name=57)
    pp.create_line(net, from_bus=b55, to_bus=b57, length_km=0.0118, std_type="3x16_Al", name='55_57')
    pp.create_load(net, bus=57, name=2120911132, p_mw=0.001)
    # tovabb b54-rol
    b58 = pp.create_bus(net, vn_kv=0.4, name=58)
    pp.create_line(net, from_bus=b54, to_bus=b58, length_km=0.0371, std_type="3x70_Al_plus_50_Al", name='54_58')
    # balra lejjebb
    b59 = pp.create_bus(net, vn_kv=0.4, name=59)
    pp.create_line(net, from_bus=b58, to_bus=b59, length_km=0.08, std_type="4x50_Al_kbl", name='58_59')
    pp.create_load(net, bus=59, name=2120911137, p_mw=0.001)
    # balra feljebb
    b60 = pp.create_bus(net, vn_kv=0.4, name=60)
    pp.create_line(net, from_bus=b58, to_bus=b60, length_km=0.0407, std_type="3x10_Al_plus_25_Al", name='58_60')
    pp.create_load(net, bus=60, name=2120908679, p_mw=0.001)
    pp.create_load(net, bus=60, name=2120909587, p_mw=0.001)
    b61 = pp.create_bus(net, vn_kv=0.4, name=60)
    pp.create_line(net, from_bus=b58, to_bus=b61, length_km=0.0343, std_type="3x70_Al_plus_50_Al", name='58_61')
    pp.create_load(net, bus=61, name=2120908856, p_mw=0.001)
    # B2
    b62 = pp.create_bus(net, vn_kv=0.4, name=62)
    pp.create_switch(net, bus=trafo_lv_side, element=b62, et='b', type='CB', name='B3')
    b63 = pp.create_bus(net, vn_kv=0.4, name=63)
    pp.create_line(net, from_bus=b62, to_bus=b63, length_km=0.0081, std_type="4x95 Ml", name='62_63')
    pp.create_load(net, bus=63, name=2124380322, p_mw=0.001)
    b64 = pp.create_bus(net, vn_kv=0.4, name=64)
    pp.create_line(net, from_bus=b63, to_bus=b64, length_km=0.0348, std_type="4x95 Ml", name='63_64')
    pp.create_load(net, bus=64, name=2120910566, p_mw=0.001)
    pp.create_load(net, bus=64, name=2120911337, p_mw=0.001)
    b65 = pp.create_bus(net, vn_kv=0.4, name=65)
    pp.create_line(net, from_bus=b64, to_bus=b65, length_km=0.0314, std_type="3x70_Al_plus_50_Al", name='64_65')
    pp.create_load(net, bus=65, name=2120910592, p_mw=0.001)
    pp.create_load(net, bus=65, name=2120909457, p_mw=0.001)
    pp.create_load(net, bus=65, name=2120910306, p_mw=0.001)
    b66 = pp.create_bus(net, vn_kv=0.4, name=66)
    pp.create_line(net, from_bus=b65, to_bus=b66, length_km=0.0335, std_type="3x70_Al_plus_50_Al", name='65_66')
    pp.create_load(net, bus=66, name=2120910172, p_mw=0.001)
    pp.create_load(net, bus=66, name=2120909836, p_mw=0.001)
    pp.create_load(net, bus=66, name=2120910301, p_mw=0.001)
    pp.create_load(net, bus=66, name=2120908580, p_mw=0.001)
    b67 = pp.create_bus(net, vn_kv=0.4, name=67)
    pp.create_line(net, from_bus=b66, to_bus=b67, length_km=0.0233, std_type="3x70_Al_plus_50_Al", name='66_67')
    # ketto hianyzik 246, 76 helyr szam
    b68 = pp.create_bus(net, vn_kv=0.4, name=68)
    pp.create_line(net, from_bus=b67, to_bus=b68, length_km=0.0249, std_type="3x70_Al_plus_50_Al", name='67_68')
    pp.create_load(net, bus=68, name=2120910536, p_mw=0.001)
    b69 = pp.create_bus(net, vn_kv=0.4, name=69)
    pp.create_line(net, from_bus=b68, to_bus=b69, length_km=0.0292, std_type="3x70_Al_plus_50_Al", name='68_69')
    pp.create_load(net, bus=69, name=2120910044, p_mw=0.001)
    pp.create_load(net, bus=69, name=2120910936, p_mw=0.001)
    pp.create_load(net, bus=69, name=2120910739, p_mw=0.001)
    b70 = pp.create_bus(net, vn_kv=0.4, name=70)
    pp.create_line(net, from_bus=b69, to_bus=b70, length_km=0.0424, std_type="3x70_Al_plus_50_Al", name='69_70')
    pp.create_load(net, bus=70, name=2120909818, p_mw=0.001)
    pp.create_load(net, bus=70, name=2120909548, p_mw=0.001)
    # jobbra be egy hianyzik helyr 252
    b71 = pp.create_bus(net, vn_kv=0.4, name=71)
    pp.create_line(net, from_bus=b70, to_bus=b71, length_km=0.0390, std_type="3x70_Al_plus_50_Al", name='70_71')
    pp.create_load(net, bus=71, name=2120910328, p_mw=0.001)
    pp.create_load(net, bus=71, name=2124381070, p_mw=0.001)
    pp.create_load(net, bus=71, name=2120910185, p_mw=0.001)
    # jobbra mini-leagazas ket fogyasztohoz
    b72 = pp.create_bus(net, vn_kv=0.4, name=72)
    pp.create_line(net, from_bus=b71, to_bus=b72, length_km=0.0206, std_type="4x10_ML", name='71_72')
    pp.create_load(net, bus=72, name=2120909663, p_mw=0.001)
    pp.create_load(net, bus=72, name=2120909689, p_mw=0.001)
    # b59-rol L alakban egy mĂˇsik fogyasztohoz
    b73 = pp.create_bus(net, vn_kv=0.4, name=73)
    pp.create_line(net, from_bus=b71, to_bus=b73, length_km=0.07744, std_type="4x10_ML", name='71_73')
    pp.create_load(net, bus=73, name=2120911101, p_mw=0.001)
    # folytatas b59-rol
    b74 = pp.create_bus(net, vn_kv=0.4, name=74)
    pp.create_line(net, from_bus=b71, to_bus=b74, length_km=0.0434, std_type="3x70_Al_plus_50_Al", name='71_74')
    pp.create_load(net, bus=74, name=2120909321, p_mw=0.001)
    pp.create_load(net, bus=74, name=2120909844, p_mw=0.001)
    # balra el
    b75 = pp.create_bus(net, vn_kv=0.4, name=75)
    pp.create_line(net, from_bus=b74, to_bus=b75, length_km=0.0185, std_type="4x25_ML", name='74_75')
    pp.create_load(net, bus=75, name=2120909954, p_mw=0.001)
    pp.create_load(net, bus=75, name=2120909037, p_mw=0.001)
    pp.create_load(net, bus=75, name=2120909139, p_mw=0.001)
    # balra el egy fogyasztohoz
    b76 = pp.create_bus(net, vn_kv=0.4, name=76)
    pp.create_line(net, from_bus=b75, to_bus=b76, length_km=0.037, std_type="4x25_ML", name='75_76')
    pp.create_load(net, bus=76, name=2120909139, p_mw=0.001)
    # folytatas b63-rol
    b77 = pp.create_bus(net, vn_kv=0.4, name=77)
    pp.create_line(net, from_bus=b75, to_bus=b77, length_km=0.030, std_type="4x25_ML", name='75_77')
    b78 = pp.create_bus(net, vn_kv=0.4, name=78)
    pp.create_line(net, from_bus=b77, to_bus=b78, length_km=0.0289, std_type="4x25_ML", name='77_78')
    pp.create_load(net, bus=78, name=2120908545, p_mw=0.001)
    pp.create_load(net, bus=78, name=2120909368, p_mw=0.001)
    b79 = pp.create_bus(net, vn_kv=0.4, name=79)
    pp.create_line(net, from_bus=b78, to_bus=b79, length_km=0.0345, std_type="4x25_ML", name='78_79')
    pp.create_load(net, bus=79, name=2120910470, p_mw=0.001)
    b80 = pp.create_bus(net, vn_kv=0.4, name=80)
    pp.create_line(net, from_bus=b79, to_bus=b80, length_km=0.0356, std_type="4x25_ML", name='79_80')
    pp.create_load(net, bus=80, name=2120909724, p_mw=0.001)
    pp.create_load(net, bus=80, name=2120909562, p_mw=0.001)
    pp.create_load(net, bus=80, name=1080270110, p_mw=0.001)
    b81 = pp.create_bus(net, vn_kv=0.4, name=81)
    pp.create_line(net, from_bus=b80, to_bus=b81, length_km=0.0215, std_type="4x25_ML", name='80_81')
    pp.create_load(net, bus=81, name=2120909652, p_mw=0.001)
    b82 = pp.create_bus(net, vn_kv=0.4, name=82)
    pp.create_line(net, from_bus=b81, to_bus=b82, length_km=0.0329, std_type="4x25_ML", name='81_82')
    pp.create_load(net, bus=82, name=2120910359, p_mw=0.001)
    pp.create_load(net, bus=82, name=2120911243, p_mw=0.001)
    pp.create_load(net, bus=82, name=2120909850, p_mw=0.001)
    # folytatas b62-rol
    b83 = pp.create_bus(net, vn_kv=0.4, name=83)
    pp.create_line(net, from_bus=b82, to_bus=b83, length_km=0.0411, std_type="3x70_Al_plus_50_Al", name='82_83')
    pp.create_load(net, bus=83, name=2120909251, p_mw=0.001)
    pp.create_load(net, bus=83, name=2120910292, p_mw=0.001)
    pp.create_load(net, bus=83, name=2120908844, p_mw=0.001)
    b84 = pp.create_bus(net, vn_kv=0.4, name=84)
    pp.create_line(net, from_bus=b83, to_bus=b84, length_km=0.0332, std_type="3x70_Al_plus_50_Al", name='83_84')
    # leagazas balra
    b85 = pp.create_bus(net, vn_kv=0.4, name=85)
    pp.create_line(net, from_bus=b84, to_bus=b85, length_km=0.0269, std_type="10_Al_plus_25_Al", name='84_85')
    pp.create_load(net, bus=85, name=2120911474, p_mw=0.001)
    pp.create_load(net, bus=85, name=2120909028, p_mw=0.001)
    pp.create_load(net, bus=85, name=2120908950, p_mw=0.001)
    pp.create_load(net, bus=85, name=2120911214, p_mw=0.001)
    # leagazas jobbra
    b86 = pp.create_bus(net, vn_kv=0.4, name=86)
    pp.create_line(net, from_bus=b84, to_bus=b86, length_km=0.0175, std_type="3x10_Al_plus_25_Al", name='84_86')
    pp.create_load(net, bus=86, name=2120908790, p_mw=0.001)
    pp.create_load(net, bus=86, name=2120911355, p_mw=0.001)
    b87 = pp.create_bus(net, vn_kv=0.4, name=87)
    pp.create_line(net, from_bus=b86, to_bus=b87, length_km=0.0392, std_type="3x10_Al_plus_25_Al", name='86_87')
    pp.create_load(net, bus=87, name=2120911185, p_mw=0.001)
    pp.create_load(net, bus=87, name=2120911380, p_mw=0.001)
    pp.create_load(net, bus=87, name=2120911037, p_mw=0.001)
    b88 = pp.create_bus(net, vn_kv=0.4, name=88)
    pp.create_line(net, from_bus=b87, to_bus=b88, length_km=0.044, std_type="3x10_Al_plus_25_Al", name='87_88')
    pp.create_load(net, bus=88, name=2120908809, p_mw=0.001)
    # folytatas b72-rol es el balra
    b89 = pp.create_bus(net, vn_kv=0.4, name=89)
    pp.create_line(net, from_bus=b84, to_bus=b89, length_km=0.0283, std_type="4x50_ML", name='84_89')
    pp.create_load(net, bus=89, name=2120909681, p_mw=0.001)
    b90 = pp.create_bus(net, vn_kv=0.4, name=90)
    pp.create_line(net, from_bus=b89, to_bus=b90, length_km=0.0372, std_type="4x50_ML", name='89_90')
    pp.create_load(net, bus=90, name=2124380939, p_mw=0.001)
    pp.create_load(net, bus=90, name=2120908657, p_mw=0.001)
    b91 = pp.create_bus(net, vn_kv=0.4, name=91)
    pp.create_line(net, from_bus=b90, to_bus=b91, length_km=0.0362, std_type="4x50_ML", name='90_91')
    pp.create_load(net, bus=91, name=2120910125, p_mw=0.001)
    b92 = pp.create_bus(net, vn_kv=0.4, name=92)
    pp.create_line(net, from_bus=b91, to_bus=b92, length_km=0.0371, std_type="4x50_ML", name='91_92')
    pp.create_load(net, bus=92, name=2120910992, p_mw=0.001)
    pp.create_load(net, bus=92, name=2120909198, p_mw=0.001)
    # egy hianyzik #117 vagy 118 helyr szam
    b93 = pp.create_bus(net, vn_kv=0.4, name=93)
    pp.create_line(net, from_bus=b92, to_bus=b93, length_km=0.0382, std_type="4x10_ML", name='92_93')
    pp.create_load(net, bus=93, name=2120909599, p_mw=0.001)
    pp.create_load(net, bus=93, name=2120910133, p_mw=0.001)
    pp.create_load(net, bus=93, name=2120909657, p_mw=0.001)
    b94 = pp.create_bus(net, vn_kv=0.4, name=94)
    pp.create_line(net, from_bus=b89, to_bus=b94, length_km=0.0289, std_type="4x25_ML", name='89_94')
    pp.create_load(net, bus=94, name=2120910993, p_mw=0.001)
    pp.create_load(net, bus=94, name=2120911400, p_mw=0.001)
    pp.create_load(net, bus=94, name=2120909469, p_mw=0.001)
    b95 = pp.create_bus(net, vn_kv=0.4, name=95)
    pp.create_line(net, from_bus=b94, to_bus=b95, length_km=0.0341, std_type="4x25_ML", name='94_95')
    pp.create_load(net, bus=95, name=2120909777, p_mw=0.001)
    pp.create_load(net, bus=95, name=2120909872, p_mw=0.001)
    pp.create_load(net, bus=95, name=2120911262, p_mw=0.001)
    pp.create_load(net, bus=95, name=2120910555, p_mw=0.001)
    b96 = pp.create_bus(net, vn_kv=0.4, name=96)
    pp.create_line(net, from_bus=b95, to_bus=b96, length_km=0.0261, std_type="4x25_ML", name='95_96')
    b97 = pp.create_bus(net, vn_kv=0.4, name=97)
    pp.create_line(net, from_bus=b96, to_bus=b97, length_km=0.0391, std_type="4x25_ML", name='96_97')
    pp.create_load(net, bus=97, name=2120910554, p_mw=0.001)
    pp.create_load(net, bus=97, name=2120909908, p_mw=0.001)
    b98 = pp.create_bus(net, vn_kv=0.4, name=98)
    pp.create_line(net, from_bus=b97, to_bus=b98, length_km=0.0454, std_type="4x25_ML", name='97_98')
    # print network and run power flow
    pp.add_zero_impedance_parameters(net)
    '''
    in case of run:
    print(net.line)
    print(net.bus)
    print(net.trafo)
    pp.runpp(net, calculate_voltage_angles=True, init='auto', max_iteration='auto',
             tolerance_mva=1e-08, enforce_q_lims=False, numba=True, recycle=None,
             check_connectivity=True, switch_rx_ratio=2.0, delta_q=0, v_debug=False)
    print(net.res_bus.vm_pu)
    print(net.res_line.loading_percent)
    '''
    return net


if __name__ == "__main__":
    net = create()
